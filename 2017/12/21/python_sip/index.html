
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Requests对摘要认证的处理 | Liecol&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="google-site-verification" content="KD9n1FRuBzVpoapy6t7dZdow7NG_SI4RKZ7dEPjkr0o" />
  <meta name="description" content="许多 web 服务都需要身份认证，并且也有多种不同的认证类型。下面笔者着重说一下摘要认证以及python包Requests对摘要认证的处理。首先，Requests对摘要认证其实是开箱即用的。如下：123from requests.auth import HTTPDigestAuthurl = &apos;http://digest.cereson.cn/auth/index.php&apos;requests.get">
<meta property="og:type" content="article">
<meta property="og:title" content="Requests对摘要认证的处理">
<meta property="og:url" content="http://bin.bloggao.cn/2017/12/21/python_sip/index.html">
<meta property="og:site_name" content="Liecol's Blog">
<meta property="og:description" content="许多 web 服务都需要身份认证，并且也有多种不同的认证类型。下面笔者着重说一下摘要认证以及python包Requests对摘要认证的处理。首先，Requests对摘要认证其实是开箱即用的。如下：123from requests.auth import HTTPDigestAuthurl = &apos;http://digest.cereson.cn/auth/index.php&apos;requests.get">
<meta property="og:updated_time" content="2017-12-25T10:50:40.444Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Requests对摘要认证的处理">
<meta name="twitter:description" content="许多 web 服务都需要身份认证，并且也有多种不同的认证类型。下面笔者着重说一下摘要认证以及python包Requests对摘要认证的处理。首先，Requests对摘要认证其实是开箱即用的。如下：123from requests.auth import HTTPDigestAuthurl = &apos;http://digest.cereson.cn/auth/index.php&apos;requests.get">
  
    <link rel="alternative" href="/atom.xml" title="Liecol&#39;s Blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css">
  <!--[if lt IE 9]><script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7/html5shiv.min.js"></script><![endif]-->
  
  <script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  <link href="http://cdn.staticfile.org/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
  <script>
    (function(){
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
        }
        else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
    </script>
    <meta name="keywords" content="liecol-晓斌个人网站,高晓斌网站, 高晓斌, 高晓斌博客, 望江县第三中学, 北京城市学院, 高晓斌blog, hexo博客">
    <meta name="google-site-verification" content="KD9n1FRuBzVpoapy6t7dZdow7NG_SI4RKZ7dEPjkr0o" />
</head>
<body>
<div id="container">
  <div id="wrap">
    <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Liecol&#39;s Blog</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">技术，源于对生活的分享，所谓迷茫，就是才华配不上梦想！</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//www.baidu.com/baidu" method="get" accept-charset="utf-8" class="search-form">
          <input type="search" name="word" maxlength="20" class="search-form-input" placeholder="Search">
          <input type="submit" value="" class="search-form-submit">
          <input name=tn type=hidden value="bds">
          <input name=cl type=hidden value="3">
          <input name=ct type=hidden value="2097152">
          <input type="hidden" name="si" value="bin.bloggao.cn">
        </form>
      </div>
    </div>
  </div>
</header>
    <div class="outer">
      <section id="main"><article id="post-python_sip" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/12/21/python_sip/" class="article-date">
  <time datetime="2017-12-21T10:25:50.000Z" itemprop="datePublished">2017-12-21</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/python/">python</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Requests对摘要认证的处理
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>许多 web 服务都需要身份认证，并且也有多种不同的认证类型。<br>下面笔者着重说一下摘要认证以及python包Requests对摘要认证的处理。<br>首先，Requests对摘要认证其实是开箱即用的。<br>如下：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> requests.auth <span class="keyword">import</span> HTTPDigestAuth</div><div class="line">url = <span class="string">'http://digest.cereson.cn/auth/index.php'</span></div><div class="line">requests.get(url, auth=HTTPDigestAuth(<span class="string">'user'</span>, <span class="string">'passwd'</span>))</div></pre></td></tr></table></figure></p>
<p>接下来说一下什么是摘要认证：<br>首先摘要认证被设计用来弥补基本认证的缺点。<br>摘要认证基于请求-响应（challenge-response）模式，<br>而且使用了哈希加密算法（常用为MD5），从而某些程度上解决了基本认证安全性的问题。<br>服务器返回的初始401响应的www认证头（WWW-Authenticate header）中多出了一个称为nonce的随机数的字段。<br>服务端保证每个401响应中的nonce值唯一。如：<br><code>Authorization: Digest username=&quot;admin&quot;, realm=&quot;HiPER&quot;</code></p>
<p>接下来的客户端响应中将包含由用户名、密码、nonce和其他信息组成的数据的哈希值（如使用MD5加密）。<br>所有被加密的数据服务端也具有，因此服务端执行同样加密过程。如果二者一致则认证成功。<br>因为如MD5等哈希加密算法是不可逆的，因此用户名密码明文无法被窃听破解。<br>因为服务器对同一个nonce的请求只接受一次客户端请求，从而能避免重放攻击。<br>但是，digest的安全性也有缺点：</p>
<ul>
<li>只有密码密码被加密，而客户端最终请求的被保护资源是明文传送的，可被窃听</li>
<li>客户端无法确认服务端的正确身份，缺少对服务端的认证方式</li>
<li>近年来，随着计算机性能的提高等因素，传统高强度加密算法的破解已成可能。而MD5更是已有破解方法。<a id="more"></a>
</li>
</ul>
<h5 id="通俗点说："><a href="#通俗点说：" class="headerlink" title="通俗点说："></a>通俗点说：</h5><p>客户端首次向服务器发送HTTP请求，服务器返回401（未授权）响应进行挑战。<br>401消息的头里带有WWW-Authenticate消息头，其中包含挑战摘要的随机参数nonce。<br>客户端收到401后，将用户名密码和挑战信息用MD5加密形成认证鉴权头，重新发送给服务器，服务器对认证鉴权头进行验证，<br>如果认证成功则返回200 OK并返回操作的Cookie,在后续的访问中客户端只需要使用该分配的Cookie进行服务操作即可。</p>
<p>服务器的401未授权挑战WWW-Authenticate消息头语法：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">* challenge        = <span class="string">"Digest"</span> digest-challenge</div><div class="line">* digest-challenge = <span class="number">1</span><span class="comment">#( realm | [ domain ] | nonce | [opaque] |[stale] | [algorithm] | [qop-options] | [auth-param] )</span></div><div class="line">* domain            = <span class="string">"domain"</span> <span class="string">"="</span> &lt;<span class="string">"&gt; URI ( 1*SP URI ) &lt;"</span>&gt;</div><div class="line">* URI               = absoluteURI | abs_path</div><div class="line">* nonce             = <span class="string">"nonce"</span> <span class="string">"="</span> nonce-value</div><div class="line">* nonce-value       = quoted-string</div><div class="line">* opaque            = <span class="string">"opaque"</span> <span class="string">"="</span> quoted-string</div><div class="line">* stale             = <span class="string">"stale"</span> <span class="string">"="</span> ( <span class="string">"true"</span> | <span class="string">"false"</span> )</div><div class="line">* algorithm         = <span class="string">"algorithm"</span> <span class="string">"="</span> ( <span class="string">"MD5"</span> | <span class="string">"MD5-sess"</span> | token )</div><div class="line">* qop-options       = <span class="string">"qop"</span> <span class="string">"="</span> &lt;<span class="string">"&gt; 1#qop-value &lt;"</span>&gt;</div><div class="line">* qop-value         = <span class="string">"auth"</span> | <span class="string">"auth-int"</span> | token</div></pre></td></tr></table></figure></p>
<h5 id="备注："><a href="#备注：" class="headerlink" title="备注："></a>备注：</h5><ul>
<li>realm：让客户知道使用哪个用户名和密码的字符串。不同的领域可能密码不一样。至少告诉用户是什么主机做认证，他可能会提示用哪个用户名登录，类似一个Email。</li>
<li>domain：一个URI列表，指示要保护的域。可能是一个列表。提示用户这些URI采用一样的认证。如果为空或忽略则为整个服务器。</li>
<li>nonce：随机字符串，每次401都不一样。跟算法有关。算法类似Base64加密：time-stamp H(time-stamp “:” ETag “:” private-key) 。time-stamp为服务器时钟，ETag为请求的Etag头。private-key为服务器知道的一个值。</li>
<li>opaque：服务器产生的由客户下去请求时原样返回。最好是Base64串或十六进制字符串。</li>
<li>auth-param：为扩展用的，现阶段忽略。</li>
</ul>
<p>摘要的计算方法：<br>客户端的挑战响应消息头语法：<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">credentials   =“Digest" digest-response</div><div class="line">digest-response=1#( username | realm | nonce | digest-uri</div><div class="line">               | response | [ algorithm ] | [cnonce] |</div><div class="line">               [opaque] | [message-qop] |</div><div class="line">                   [nonce-count]  | [auth-param] )</div><div class="line">username      ="username" "=" username-value</div><div class="line">username-value =quoted-string</div><div class="line">digest-uri    =“uri" "=" digest-uri-value</div><div class="line">digest-uri-value=request-uri   ; As specified by HTTP/1.1</div><div class="line">message-qop   =“qop" "=" qop-value</div><div class="line">cnonce        =“cnonce" "=" cnonce-value</div><div class="line">cnonce-value   =nonce-value</div><div class="line">nonce-count   =“nc" "=" nc-value</div><div class="line">nc-value       =8LHEX</div><div class="line">response      =“response" "=" request-digest</div><div class="line">request-digest=&lt;"&gt; 32LHEX &lt;"&gt;</div><div class="line">LHEX           ="0" | "1" | "2" | "3" |</div><div class="line">                   "4" | "5" | "6" | "7" |</div><div class="line">                   "8" | "9" | "a" | "b" |</div><div class="line">                   "c" | "d" | "e" | "f"</div></pre></td></tr></table></figure></p>
<table>
<thead>
<tr>
<th>参数名称</th>
<th style="text-align:left">说明</th>
<th style="text-align:center">必填</th>
<th style="text-align:center">数据类型</th>
<th style="text-align:center">备注</th>
</tr>
</thead>
<tbody>
<tr>
<td>username</td>
<td style="text-align:left">用户名</td>
<td style="text-align:center">Y</td>
<td style="text-align:center">xsd:string</td>
<td style="text-align:center">客户端ID或者VcuId</td>
</tr>
<tr>
<td>realm</td>
<td style="text-align:left">用户域</td>
<td style="text-align:center">Y</td>
<td style="text-align:center">xsd:string</td>
<td style="text-align:center">告知用户使用哪个域的用户名密码登录。这里如“bj.hyc.cn”</td>
</tr>
<tr>
<td>nonce</td>
<td style="text-align:left">摘要质询参数</td>
<td style="text-align:center">Y</td>
<td style="text-align:center">xsd:string</td>
<td style="text-align:center">返回请求一响应中的参数nonce</td>
</tr>
<tr>
<td>uri</td>
<td style="text-align:left">访问路径</td>
<td style="text-align:center">Y</td>
<td style="text-align:center">xsd:string</td>
<td style="text-align:center">请求的URI</td>
</tr>
<tr>
<td>qop</td>
<td style="text-align:left">保护质量</td>
<td style="text-align:center">Y</td>
<td style="text-align:center">xsd:string</td>
<td style="text-align:center">auth：鉴权，不对消息体做完整性验证。</td>
</tr>
<tr>
<td></td>
<td style="text-align:left"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center">auth-int：鉴权并需要对消息体做摘要，保证消息完整性。</td>
</tr>
<tr>
<td></td>
<td style="text-align:left"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center">注册过程使用auth。</td>
</tr>
<tr>
<td>nc</td>
<td style="text-align:left">nonce计数参数</td>
<td style="text-align:center">Y</td>
<td style="text-align:center">xsd:string</td>
<td style="text-align:center">客户端请求的十六进制计数，以00000001开始，每次请求加1，目的是防止重放攻击。</td>
</tr>
<tr>
<td>cnonce</td>
<td style="text-align:left">客户端nonce值</td>
<td style="text-align:center">Y</td>
<td style="text-align:center">xsd:string</td>
<td style="text-align:center">客户端用来鉴定服务器的摘要质询参数，本版本暂不实现客户端对服务器的认证</td>
</tr>
<tr>
<td>response</td>
<td style="text-align:left">响应值</td>
<td style="text-align:center">Y</td>
<td style="text-align:center">xsd:string</td>
<td style="text-align:center">对请求一中401响应的参数采用MD5算法做摘要计算的结果</td>
</tr>
<tr>
<td>opaque</td>
<td style="text-align:left">会话标识</td>
<td style="text-align:center">Y</td>
<td style="text-align:center">xsd:string</td>
<td style="text-align:center">返回服务器原值</td>
</tr>
</tbody>
</table>
<p>response参数计算算法：<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">response=&lt;"&gt; &lt; KD ( H(A1), unq(nonce-value)</div><div class="line">":" nc-value</div><div class="line">":" unq(cnonce-value)</div><div class="line">":" unq(qop-value)</div><div class="line">":" H(A2)</div><div class="line">) &lt;"&gt;</div><div class="line">A1=unq(username-value) ":" unq(realm-value) ":" passwd</div><div class="line">如果qop等于auth，A2=Method ":" digest-uri-value</div><div class="line">如果qop等于auth-int，A2=Method ":" digest-uri-value ":" H(entity-body)</div><div class="line">其中：</div><div class="line">1)  H(data)=MD5(data)。</div><div class="line">2)  KD(secret, data)=H(concat(secret, ":", data))。</div><div class="line">3)  unq(X)代表去掉X前后的引号。</div><div class="line">4)  Method=GET或者POST。</div><div class="line">5)  entity-body代表HTTP请求的消息体。</div><div class="line">6)  passwd=key。</div></pre></td></tr></table></figure></p>
<p>服务器在收到客户端的挑战响应消息后，根据Authorization消息头中的username参数，<br>取出对应的key和key的有效期，然后使用和客户端相同的计算方法，<br>对Authorization消息头中的参数进行摘要计算，将计算结果与response值进行比较，<br>相同则鉴权成功，返回200 OK响应，不同则鉴权失败，重新返回401 Unauthorized响应，格式与请求一的401响应相同。</p>
<p>rspauth参数计算算法：<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">rspauth=&lt;"&gt; &lt; KD(H(A1),unq(nextnonce-value)</div><div class="line">":"nc-value</div><div class="line">":"unq(cnonce-value)</div><div class="line">":"unq(qop-value)</div><div class="line">":"H(A2)</div><div class="line">)&lt;"&gt;</div><div class="line">A1=unq(username-value)":"unq(realm-value)":"passwd</div><div class="line">如果qop等于auth，A2=":" digest-uri-value</div><div class="line">如果qop等于auth-int，A2=":" digest-uri-value ":" H(entity-body)</div><div class="line">其中：</div><div class="line">1) H(data)=MD5(data)。</div><div class="line">2) KD(secret, data)=H(concat(secret, ":", data))。</div><div class="line">3) unq(X)代表去掉X前后的引号。</div><div class="line">4) entity-body代表HTTP请求的消息体。</div><div class="line">5) passwd=key。</div></pre></td></tr></table></figure></p>
<h5 id="示例："><a href="#示例：" class="headerlink" title="示例："></a>示例：</h5><p>首次接入进行挑战过程，假设操作为登陆接(实际可能不存在该接口，此处只是举例说明)，用户名为abc@123.com 密码为111111.</p>
<p>请求：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">GET /login HTTP/<span class="number">1.1</span></div><div class="line">Host: <span class="number">123.</span>com</div></pre></td></tr></table></figure></p>
<p>应答401挑战：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">HTTP/<span class="number">1.1</span> <span class="number">401</span> Unauthorized </div><div class="line">WWW-Authenticate:Digest realm=<span class="string">"123.com"</span>,nonce=<span class="string">"30373034323033393432343638323539"</span>,qop=auth</div></pre></td></tr></table></figure></p>
<p>认证请求：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">GET /login HTTP/<span class="number">1.1</span></div><div class="line">Host: <span class="number">123.</span>com</div><div class="line">Authorization:Digest realm=<span class="string">"123.com"</span>,nonce=<span class="string">"30373034323033393432343638323539"</span>,username=<span class="string">"abc@123.com"</span>,qop=auth,uri=<span class="string">"/banklogin"</span>,response=<span class="string">"7a086bb798e81d0c815fc3fc32238bc6"</span>,cnonce=<span class="string">"b1ce32121cb97d8dde121f3e8421288e"</span>,nc=<span class="number">00000001</span>, algorithm=<span class="string">"MD5"</span></div><div class="line">Date: Sun,<span class="number">4</span> Jul <span class="number">2010</span> <span class="number">12</span>:<span class="number">39</span>:<span class="number">43</span> GMT</div></pre></td></tr></table></figure></p>
<p>成功响应：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">HTTP/<span class="number">1.0</span> <span class="number">200</span> OK </div><div class="line">Server: webserver</div><div class="line">ContentType:application/json;charset=utf8</div><div class="line">Set-Cookie: JSESSIONID=<span class="number">07205746E416581</span>AADD6BBAFB053804C</div></pre></td></tr></table></figure></p>
<p>只需用在后续的请求中携带Cookie即可。</p>
<p>笔者在这也翻了一下Requests对于摘要认证的处理,方便大家参考：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">HTTPDigestAuth</span><span class="params">(AuthBase)</span>:</span></div><div class="line">    <span class="string">"""Attaches HTTP Digest Authentication to the given Request object."""</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, username, password)</span>:</span></div><div class="line">        self.username = username</div><div class="line">        self.password = password</div><div class="line">        <span class="comment"># Keep state in per-thread local storage</span></div><div class="line">        self._thread_local = threading.local()</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">init_per_thread_state</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="comment"># Ensure state is initialized just once per-thread</span></div><div class="line">        <span class="keyword">if</span> <span class="keyword">not</span> hasattr(self._thread_local, <span class="string">'init'</span>):</div><div class="line">            self._thread_local.init = <span class="keyword">True</span></div><div class="line">            self._thread_local.last_nonce = <span class="string">''</span></div><div class="line">            self._thread_local.nonce_count = <span class="number">0</span></div><div class="line">            self._thread_local.chal = &#123;&#125;</div><div class="line">            self._thread_local.pos = <span class="keyword">None</span></div><div class="line">            self._thread_local.num_401_calls = <span class="keyword">None</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">build_digest_header</span><span class="params">(self, method, url)</span>:</span></div><div class="line">        <span class="string">"""</span></div><div class="line">        :rtype: str</div><div class="line">        """</div><div class="line"></div><div class="line">        realm = self._thread_local.chal[<span class="string">'realm'</span>]</div><div class="line">        nonce = self._thread_local.chal[<span class="string">'nonce'</span>]</div><div class="line">        qop = self._thread_local.chal.get(<span class="string">'qop'</span>)</div><div class="line">        algorithm = self._thread_local.chal.get(<span class="string">'algorithm'</span>)</div><div class="line">        opaque = self._thread_local.chal.get(<span class="string">'opaque'</span>)</div><div class="line">        hash_utf8 = <span class="keyword">None</span></div><div class="line"></div><div class="line">        <span class="keyword">if</span> algorithm <span class="keyword">is</span> <span class="keyword">None</span>:</div><div class="line">            _algorithm = <span class="string">'MD5'</span></div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            _algorithm = algorithm.upper()</div><div class="line">        <span class="comment"># lambdas assume digest modules are imported at the top level</span></div><div class="line">        <span class="keyword">if</span> _algorithm == <span class="string">'MD5'</span> <span class="keyword">or</span> _algorithm == <span class="string">'MD5-SESS'</span>:</div><div class="line">            <span class="function"><span class="keyword">def</span> <span class="title">md5_utf8</span><span class="params">(x)</span>:</span></div><div class="line">                <span class="keyword">if</span> isinstance(x, str):</div><div class="line">                    x = x.encode(<span class="string">'utf-8'</span>)</div><div class="line">                <span class="keyword">return</span> hashlib.md5(x).hexdigest()</div><div class="line">            hash_utf8 = md5_utf8</div><div class="line">        <span class="keyword">elif</span> _algorithm == <span class="string">'SHA'</span>:</div><div class="line">            <span class="function"><span class="keyword">def</span> <span class="title">sha_utf8</span><span class="params">(x)</span>:</span></div><div class="line">                <span class="keyword">if</span> isinstance(x, str):</div><div class="line">                    x = x.encode(<span class="string">'utf-8'</span>)</div><div class="line">                <span class="keyword">return</span> hashlib.sha1(x).hexdigest()</div><div class="line">            hash_utf8 = sha_utf8</div><div class="line"></div><div class="line">        KD = <span class="keyword">lambda</span> s, d: hash_utf8(<span class="string">"%s:%s"</span> % (s, d))</div><div class="line"></div><div class="line">        <span class="keyword">if</span> hash_utf8 <span class="keyword">is</span> <span class="keyword">None</span>:</div><div class="line">            <span class="keyword">return</span> <span class="keyword">None</span></div><div class="line"></div><div class="line">        <span class="comment"># XXX not implemented yet</span></div><div class="line">        entdig = <span class="keyword">None</span></div><div class="line">        p_parsed = urlparse(url)</div><div class="line">        <span class="comment">#: path is request-uri defined in RFC 2616 which should not be empty</span></div><div class="line">        path = p_parsed.path <span class="keyword">or</span> <span class="string">"/"</span></div><div class="line">        <span class="keyword">if</span> p_parsed.query:</div><div class="line">            path += <span class="string">'?'</span> + p_parsed.query</div><div class="line"></div><div class="line">        A1 = <span class="string">'%s:%s:%s'</span> % (self.username, realm, self.password)</div><div class="line">        A2 = <span class="string">'%s:%s'</span> % (method, path)</div><div class="line"></div><div class="line">        HA1 = hash_utf8(A1)</div><div class="line">        HA2 = hash_utf8(A2)</div><div class="line"></div><div class="line">        <span class="keyword">if</span> nonce == self._thread_local.last_nonce:</div><div class="line">            self._thread_local.nonce_count += <span class="number">1</span></div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            self._thread_local.nonce_count = <span class="number">1</span></div><div class="line">        ncvalue = <span class="string">'%08x'</span> % self._thread_local.nonce_count</div><div class="line">        s = str(self._thread_local.nonce_count).encode(<span class="string">'utf-8'</span>)</div><div class="line">        s += nonce.encode(<span class="string">'utf-8'</span>)</div><div class="line">        s += time.ctime().encode(<span class="string">'utf-8'</span>)</div><div class="line">        s += os.urandom(<span class="number">8</span>)</div><div class="line"></div><div class="line">        cnonce = (hashlib.sha1(s).hexdigest()[:<span class="number">16</span>])</div><div class="line">        <span class="keyword">if</span> _algorithm == <span class="string">'MD5-SESS'</span>:</div><div class="line">            HA1 = hash_utf8(<span class="string">'%s:%s:%s'</span> % (HA1, nonce, cnonce))</div><div class="line"></div><div class="line">        <span class="keyword">if</span> <span class="keyword">not</span> qop:</div><div class="line">            respdig = KD(HA1, <span class="string">"%s:%s"</span> % (nonce, HA2))</div><div class="line">        <span class="keyword">elif</span> qop == <span class="string">'auth'</span> <span class="keyword">or</span> <span class="string">'auth'</span> <span class="keyword">in</span> qop.split(<span class="string">','</span>):</div><div class="line">            noncebit = <span class="string">"%s:%s:%s:%s:%s"</span> % (</div><div class="line">                nonce, ncvalue, cnonce, <span class="string">'auth'</span>, HA2</div><div class="line">                )</div><div class="line">            respdig = KD(HA1, noncebit)</div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            <span class="comment"># XXX handle auth-int.</span></div><div class="line">            <span class="keyword">return</span> <span class="keyword">None</span></div><div class="line"></div><div class="line">        self._thread_local.last_nonce = nonce</div><div class="line"></div><div class="line">        <span class="comment"># XXX should the partial digests be encoded too?</span></div><div class="line">        base = <span class="string">'username="%s", realm="%s", nonce="%s", uri="%s", '</span> \</div><div class="line">               <span class="string">'response="%s"'</span> % (self.username, realm, nonce, path, respdig)</div><div class="line">        <span class="keyword">if</span> opaque:</div><div class="line">            base += <span class="string">', opaque="%s"'</span> % opaque</div><div class="line">        <span class="keyword">if</span> algorithm:</div><div class="line">            base += <span class="string">', algorithm="%s"'</span> % algorithm</div><div class="line">        <span class="keyword">if</span> entdig:</div><div class="line">            base += <span class="string">', digest="%s"'</span> % entdig</div><div class="line">        <span class="keyword">if</span> qop:</div><div class="line">            base += <span class="string">', qop="auth", nc=%s, cnonce="%s"'</span> % (ncvalue, cnonce)</div><div class="line"></div><div class="line">        <span class="keyword">return</span> <span class="string">'Digest %s'</span> % (base)</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">handle_redirect</span><span class="params">(self, r, **kwargs)</span>:</span></div><div class="line">        <span class="string">"""Reset num_401_calls counter on redirects."""</span></div><div class="line">        <span class="keyword">if</span> r.is_redirect:</div><div class="line">            self._thread_local.num_401_calls = <span class="number">1</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">handle_401</span><span class="params">(self, r, **kwargs)</span>:</span></div><div class="line">        <span class="string">"""</span></div><div class="line">        Takes the given response and tries digest-auth, if needed.</div><div class="line"></div><div class="line">        :rtype: requests.Response</div><div class="line">        """</div><div class="line"></div><div class="line">        <span class="keyword">if</span> self._thread_local.pos <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span>:</div><div class="line">            <span class="comment"># Rewind the file position indicator of the body to where</span></div><div class="line">            <span class="comment"># it was to resend the request.</span></div><div class="line">            r.request.body.seek(self._thread_local.pos)</div><div class="line">        s_auth = r.headers.get(<span class="string">'www-authenticate'</span>, <span class="string">''</span>)</div><div class="line"></div><div class="line">        <span class="keyword">if</span> <span class="string">'digest'</span> <span class="keyword">in</span> s_auth.lower() <span class="keyword">and</span> self._thread_local.num_401_calls &lt; <span class="number">2</span>:</div><div class="line"></div><div class="line">            self._thread_local.num_401_calls += <span class="number">1</span></div><div class="line">            pat = re.compile(<span class="string">r'digest '</span>, flags=re.IGNORECASE)</div><div class="line">            self._thread_local.chal = parse_dict_header(pat.sub(<span class="string">''</span>, s_auth, count=<span class="number">1</span>))</div><div class="line"></div><div class="line">            <span class="comment"># Consume content and release the original connection</span></div><div class="line">            <span class="comment"># to allow our new request to reuse the same one.</span></div><div class="line">            r.content</div><div class="line">            r.close()</div><div class="line">            prep = r.request.copy()</div><div class="line">            extract_cookies_to_jar(prep._cookies, r.request, r.raw)</div><div class="line">            prep.prepare_cookies(prep._cookies)</div><div class="line"></div><div class="line">            prep.headers[<span class="string">'Authorization'</span>] = self.build_digest_header(</div><div class="line">                prep.method, prep.url)</div><div class="line">            _r = r.connection.send(prep, **kwargs)</div><div class="line">            _r.history.append(r)</div><div class="line">            _r.request = prep</div><div class="line"></div><div class="line">            <span class="keyword">return</span> _r</div><div class="line"></div><div class="line">        self._thread_local.num_401_calls = <span class="number">1</span></div><div class="line">        <span class="keyword">return</span> r</div></pre></td></tr></table></figure></p>

      
    </div>
    <footer class="article-footer">
      
        <a data-url="http://bin.bloggao.cn/2017/12/21/python_sip/" data-id="ckahicgli0016wgvxof3o8vk1" class="article-share-link" data-share="baidu" data-title="Requests对摘要认证的处理">分享到</a>
      

      
        <a href="http://bin.bloggao.cn/2017/12/21/python_sip/#ds-thread" class="article-comment-link">评论</a>
      

      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/http/">http</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python/">python</a></li></ul>

    </footer>
  </div>

  
    <! -- 添加版权信息 -->
    <div style="margin-top:20px;">
    <div>
    <b>注:</b> 转载请注明出处,本文作者为
    <a style="color:#e32d40;" href="/index.html" target="_blank" title="Liecol Gao">Liecol Gao</a>,
    本文标题为
    <a style="color:#e32d40;" href="/2017/12/21/python_sip/" target="_blank" title="Requests对摘要认证的处理">Requests对摘要认证的处理</a>
    </div>
    <div>
    &nbsp;&nbsp;&nbsp;&nbsp;本文链接为
    <a style="color:#e32d40;" href="/2017/12/21/python_sip/" target="_blank" title="Requests对摘要认证的处理">http://bin.bloggao.cn/2017/12/21/python_sip/</a>.
    </div>
    </div>
    <! -- 添加版权信息 -->

    
<nav id="article-nav">
  
    <a href="/2018/04/25/mysql_foreign_key/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">下一篇</strong>
      <div class="article-nav-title">
        
          Mysql 外键 Foreign Key
        
      </div>
    </a>
  
  
    <a href="/2017/12/20/python_ftp/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">上一篇</strong>
      <div class="article-nav-title">如何在Python里使用FTP</div>
    </a>
  
</nav>

  
</article>


  <!--PC和WAP自适应版-->
  <div id="SOHUCS" sid="Requests对摘要认证的处理" ></div> 
  <script type="text/javascript"> 
  (function(){ 
  var appid = 'cysWveYe9'; 
  var conf = 'prod_17d4525b97e67d157e2c5e0a2cedfcd7'; 
  var width = window.innerWidth || document.documentElement.clientWidth; 
  if (width < 960) { 
  window.document.write('<script id="changyan_mobile_js" charset="utf-8" type="text/javascript" src="http://changyan.sohu.com/upload/mobile/wap-js/changyan_mobile.js?client_id=' + appid + '&conf=' + conf + '"><\/script>'); } else { var loadJs=function(d,a){var c=document.getElementsByTagName("head")[0]||document.head||document.documentElement;var b=document.createElement("script");b.setAttribute("type","text/javascript");b.setAttribute("charset","UTF-8");b.setAttribute("src",d);if(typeof a==="function"){if(window.attachEvent){b.onreadystatechange=function(){var e=b.readyState;if(e==="loaded"||e==="complete"){b.onreadystatechange=null;a()}}}else{b.onload=a}}c.appendChild(b)};loadJs("http://changyan.sohu.com/upload/changyan.js",function(){window.changyan.api.config({appid:appid,conf:conf})}); } })(); </script>

</section>
      
      <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/nodejs/" style="font-size: 14.67px; color: #ee803d">nodejs</a> <a href="/tags/linux/" style="font-size: 23px; color: #e00">linux</a> <a href="/tags/hexo/" style="font-size: 18px; color: #ee4d25">hexo</a> <a href="/tags/coding/" style="font-size: 13px; color: #ee9a49">coding</a> <a href="/tags/Blog/" style="font-size: 16.33px; color: #ee6731">Blog</a> <a href="/tags/mysql/" style="font-size: 18px; color: #ee4d25">mysql</a> <a href="/tags/php/" style="font-size: 19.67px; color: #ee3318">php</a> <a href="/tags/Memcache/" style="font-size: 13px; color: #ee9a49">Memcache</a> <a href="/tags/nosql/" style="font-size: 14.67px; color: #ee803d">nosql</a> <a href="/tags/phpexcel/" style="font-size: 13px; color: #ee9a49">phpexcel</a> <a href="/tags/html/" style="font-size: 14.67px; color: #ee803d">html</a> <a href="/tags/other/" style="font-size: 14.67px; color: #ee803d">other</a> <a href="/tags/javascript/" style="font-size: 18px; color: #ee4d25">javascript</a> <a href="/tags/chrome/" style="font-size: 14.67px; color: #ee803d">chrome</a> <a href="/tags/google/" style="font-size: 13px; color: #ee9a49">google</a> <a href="/tags/jquery/" style="font-size: 14.67px; color: #ee803d">jquery</a> <a href="/tags/fileupload/" style="font-size: 13px; color: #ee9a49">fileupload</a> <a href="/tags/flexigrid/" style="font-size: 13px; color: #ee9a49">flexigrid</a> <a href="/tags/Apache/" style="font-size: 13px; color: #ee9a49">Apache</a> <a href="/tags/svn/" style="font-size: 13px; color: #ee9a49">svn</a> <a href="/tags/Ubuntu/" style="font-size: 13px; color: #ee9a49">Ubuntu</a> <a href="/tags/curl/" style="font-size: 13px; color: #ee9a49">curl</a> <a href="/tags/redis/" style="font-size: 14.67px; color: #ee803d">redis</a> <a href="/tags/python/" style="font-size: 21.33px; color: #ee1a0c">python</a> <a href="/tags/bfs/" style="font-size: 13px; color: #ee9a49">bfs</a> <a href="/tags/cProfile/" style="font-size: 13px; color: #ee9a49">cProfile</a> <a href="/tags/xlrd/" style="font-size: 13px; color: #ee9a49">xlrd</a> <a href="/tags/excel/" style="font-size: 13px; color: #ee9a49">excel</a> <a href="/tags/ftp/" style="font-size: 13px; color: #ee9a49">ftp</a> <a href="/tags/http/" style="font-size: 14.67px; color: #ee803d">http</a> <a href="/tags/vpn/" style="font-size: 13px; color: #ee9a49">vpn</a> <a href="/tags/smarty/" style="font-size: 13px; color: #ee9a49">smarty</a> <a href="/tags/tmux/" style="font-size: 13px; color: #ee9a49">tmux</a> <a href="/tags/wechat/" style="font-size: 13px; color: #ee9a49">wechat</a> <a href="/tags/virtualenv/" style="font-size: 14.67px; color: #ee803d">virtualenv</a> <a href="/tags/pyramid/" style="font-size: 13px; color: #ee9a49">pyramid</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">近期文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/05/21/python_google_auth/">通过python进行谷歌hotp身份验证</a>
          </li>
        
          <li>
            <a href="/2018/04/25/mysql_foreign_key/">Mysql 外键 Foreign Key</a>
          </li>
        
          <li>
            <a href="/2017/12/21/python_sip/">Requests对摘要认证的处理</a>
          </li>
        
          <li>
            <a href="/2017/12/20/python_ftp/">如何在Python里使用FTP</a>
          </li>
        
          <li>
            <a href="/2017/12/13/python_requests/">Requests 一款实用的python http库</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/curl/">curl</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/hexo/">hexo</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/javascript/">javascript</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux/">linux</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/mysql/">mysql</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/nodejs/">nodejs</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/nosql/">nosql</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/other/">other</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/php/">php</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/python/">python</a><span class="category-list-count">10</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/svn/">svn</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/wechat/">wechat</a><span class="category-list-count">1</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">五月 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">四月 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">十二月 2017</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">十月 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">九月 2017</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">七月 2017</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">四月 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">一月 2017</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/12/">十二月 2016</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">十一月 2016</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/09/">九月 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">七月 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06/">六月 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">五月 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/02/">二月 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">一月 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/11/">十一月 2015</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/09/">九月 2015</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/08/">八月 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/04/">四月 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/03/">三月 2015</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/11/">十一月 2014</a><span class="archive-list-count">1</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">友情链接</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="http://blog.newbmiao.com" target="_blank">菜鸟-Miao</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
      
    </div>
    <footer id="footer">
  
  <ul class="list-inline text-center">
    <li>
        <a target="_blank" href="http://weibo.com/liecol">
            <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-weibo fa-stack-1x fa-inverse"></i>
            </span>
        </a>
    </li>
    <li>
        <a target="_blank"  href="https://github.com/liecol-gao">
            <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
            </span>
        </a>
    </li>
    </ul>
  <p class="copyright text-muted" style='margin-top:10px;'>
    <span id="busuanzi_container_site_pv">本站总访问量<span id="busuanzi_value_site_pv"></span>次</span>
    <span id="busuanzi_container_site_uv">本站访客数<span id="busuanzi_value_site_uv"></span>人次</span>
  </p>
  <p>Hosted by <a href="https://pages.coding.me" style="font-weight: bold">Coding Pages</a></p>  
  <p class="copyright text-muted"  style='margin-top:0px;'>
      Copyright &copy; Liecol&#39;s Blog 2020 
      <br>
      Create by <a href="http://www.bloggao.cn">liecol</a> 
      <span style="display: inline-block; margin: 0 5px;">
          <i class="fa fa-heart"></i>
      </span> 
      Ported by <a href="https://github.com/liecol-gao/liecol-gao.github.io">Liecol-Github</a> | 
      京ICP备15020464号
  </p>
</footer>
  </div>
  <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
  <!-- totop start -->
<div id="totop">
<a title="返回顶部"><img src="/img/scrollup.png"/></a>
</div>

<!-- totop end -->

<!-- 多说公共js代码 start -->
<script type="text/javascript">
var duoshuoQuery = {short_name:"liecol"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0]
     || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
  </script>
<!-- 多说公共js代码 end -->


<!-- 百度分享 start -->

<div id="article-share-box" class="article-share-box">
  <div id="bdshare" class="bdsharebuttonbox article-share-links">
    <a class="article-share-weibo" data-cmd="tsina" title="分享到新浪微博"></a>
    <a class="article-share-weixin" data-cmd="weixin" title="分享到微信"></a>
    <a class="article-share-qq" data-cmd="sqq" title="分享到QQ"></a>
    <a class="article-share-renren" data-cmd="renren" title="分享到人人网"></a>
    <a class="article-share-more" data-cmd="more" title="更多"></a>
  </div>
</div>
<script>
  function SetShareData(cmd, config) {
    if (shareDataTitle && shareDataUrl) {
      config.bdText = shareDataTitle;
      config.bdUrl = shareDataUrl;
    }
    return config;
  }
  window._bd_share_config={
    "common":{onBeforeClick: SetShareData},
    "share":{"bdCustomStyle":"/css/bdshare.css"}
  };
  with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='//bdimg.share.baidu.com/static/api/js/share.js?cdnversion='+~(-new Date()/36e5)];
</script>

<!-- 百度分享 end -->

<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>




<script src="/js/script.js"></script>

</div>
</body>
</html>
