<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Liecol&#39;s Blog</title>
  <subtitle>技术，源于对生活的分享，所谓迷茫，就是才华配不上梦想！</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://bin.bloggao.cn/"/>
  <updated>2020-05-22T01:53:45.853Z</updated>
  <id>http://bin.bloggao.cn/</id>
  
  <author>
    <name>Liecol Gao</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>通过python进行谷歌hotp身份验证</title>
    <link href="http://bin.bloggao.cn/2020/05/21/python_google_auth/"/>
    <id>http://bin.bloggao.cn/2020/05/21/python_google_auth/</id>
    <published>2020-05-21T10:14:40.000Z</published>
    <updated>2020-05-22T01:53:45.853Z</updated>
    
    <content type="html"><![CDATA[<p>具体原理如下图（copy自网络）：</p>
<img src="/images/google_auth.jpg" width="700" height="280" title="liecol-晓斌|tmux liecol-晓斌|tmux">
<a id="more"></a>
<p>代码如下图：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> hmac</div><div class="line"><span class="keyword">import</span> hashlib</div><div class="line"><span class="keyword">import</span> base64</div><div class="line"><span class="keyword">import</span> struct</div><div class="line"><span class="keyword">import</span> time</div><div class="line"><span class="keyword">import</span> six</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_hotp</span><span class="params">(secret_key, intervals_no, as_string=True, casefold=True, digest_method=hashlib.sha1, token_length=<span class="number">6</span>)</span>:</span></div><div class="line">    <span class="keyword">if</span> isinstance(secret_key, six.string_types):</div><div class="line">        secret_key = secret_key.encode(<span class="string">'utf-8'</span>)</div><div class="line">    secret_key = secret_key.replace(<span class="string">b' '</span>, <span class="string">b''</span>)</div><div class="line">    <span class="keyword">try</span>:</div><div class="line">        key = base64.b32decode(secret_key, casefold=casefold)</div><div class="line">    <span class="keyword">except</span> TypeError:</div><div class="line">        <span class="keyword">raise</span> TypeError(<span class="string">'Incorrect secret_key: %s'</span> % secret_key)</div><div class="line">    msg = struct.pack(<span class="string">'&gt;Q'</span>, intervals_no)</div><div class="line">    hmac_digest = hmac.new(key, msg, digest_method).digest()</div><div class="line">    ob = hmac_digest[<span class="number">19</span>] <span class="keyword">if</span> six.PY3 <span class="keyword">else</span> ord(hmac_digest[<span class="number">19</span>])</div><div class="line">    o = ob &amp; <span class="number">15</span></div><div class="line">    token_base = struct.unpack(<span class="string">'&gt;I'</span>, hmac_digest[o:o + <span class="number">4</span>])[<span class="number">0</span>] &amp; <span class="number">0x7fffffff</span></div><div class="line">    token = token_base % (<span class="number">10</span> ** token_length)</div><div class="line">    <span class="keyword">if</span> as_string:</div><div class="line">        <span class="keyword">return</span> <span class="string">'&#123;&#123;:0&#123;&#125;d&#125;&#125;'</span>.format(token_length).format(token)</div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        <span class="keyword">return</span> token</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:</div><div class="line">        secret = <span class="string">"liecol_Gao"</span>  <span class="comment"># 去除=后转为b64后长度不能低于16</span></div><div class="line">        secret = base64.b32encode(s=secret.encode(<span class="string">'utf-8'</span>))</div><div class="line">        <span class="comment"># print(secret)</span></div><div class="line">        hotp = get_hotp(secret_key=secret, intervals_no=int(time.time()) // <span class="number">30</span>, )</div><div class="line">        print(hotp)</div><div class="line">        time.sleep(<span class="number">30</span>)</div></pre></td></tr></table></figure></p>
<p>最后结果为:<br><img src="/images/google_auth_ver.jpg" width="600" height="280" title="liecol-晓斌|tmux liecol-晓斌|tmux"></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;具体原理如下图（copy自网络）：&lt;/p&gt;
&lt;img src=&quot;/images/google_auth.jpg&quot; width=&quot;700&quot; height=&quot;280&quot; title=&quot;liecol-晓斌|tmux liecol-晓斌|tmux&quot;&gt;
    
    </summary>
    
      <category term="python" scheme="http://bin.bloggao.cn/categories/python/"/>
    
    
      <category term="chrome" scheme="http://bin.bloggao.cn//tags/chrome/"/>
    
      <category term="python" scheme="http://bin.bloggao.cn//tags/python/"/>
    
  </entry>
  
  <entry>
    <title>Mysql 外键 Foreign Key</title>
    <link href="http://bin.bloggao.cn/2018/04/25/mysql_foreign_key/"/>
    <id>http://bin.bloggao.cn/2018/04/25/mysql_foreign_key/</id>
    <published>2018-04-25T02:02:34.000Z</published>
    <updated>2018-04-25T04:40:43.130Z</updated>
    
    <content type="html"><![CDATA[<p>昨晚被朋友问到一个有关mysql外键的问题,问我删除外键再重新创建另一张表的外键，会提示key值重复，一下子问懵了，<br>潜意识告诉我不应该，但是自己做了一下操作确实如此，最后发现是建立了索引的缘故。故，在此记录一下，写一下关于我的理解。<br>既然做记录，这边就简述一下外键：</p>
<ul>
<li>如果一张表中有一个非主键的字段指向了别一张表中的主键，就将该字段叫做外键。</li>
<li>1.对子表(外键所在的表)的作用：子表在进行写操作的时候，如果外键字段在父表中找不到对应的匹配，操作就会失败。</li>
<li>2.对父表的作用：对父表的主键字段进行删和改时，如果对应的主键在子表中被引用，操作就会失败。</li>
<li>外键的定制作用：<br>  =&gt; district：严格模式(默认), 父表不能删除或更新一个被子表引用的记录。<br>  =&gt; cascade：级联模式, 父表操作后，子表关联的数据也跟着一起操作。<br>  =&gt; set null：置空模式,前提外键字段允许为NLL,  父表操作后，子表对应的字段被置空。</li>
<li>使用外键的前提：<br>  =&gt; 表储存引擎必须是innodb，否则创建的外键无约束效果。<br>  =&gt; 外键的列类型必须与父表的主键类型完全一致。<br>  =&gt; 外键的名字不能重复。<br>  =&gt; 已经存在数据的字段被设为外键时，必须保证字段中的数据与父表的主键数据对应起来。</li>
</ul>
<p>其实在现在的并发系统中，因为限制的原因，采用外键的机会个人觉得不会很多.(笔者参与的几个项目均未采用外键)<br>接下来，我们做一个验证：<br><a id="more"></a><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`tab_father`</span> (  </div><div class="line">    <span class="string">`t_first`</span> <span class="built_in">INT</span>(<span class="number">11</span>) <span class="keyword">UNSIGNED</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,  </div><div class="line">    <span class="string">`t_second`</span> <span class="built_in">INT</span>(<span class="number">11</span>) <span class="keyword">UNSIGNED</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,  </div><div class="line">    <span class="string">`ts`</span> <span class="keyword">TIMESTAMP</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">CURRENT_TIMESTAMP</span>  </div><div class="line">)  </div><div class="line"><span class="keyword">COLLATE</span>=<span class="string">'utf8_general_ci'</span>  </div><div class="line"><span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span>;</div></pre></td></tr></table></figure></p>
<p>在上面建立的这个<code>tab_father</code>表里，并未建立索引，也同样没有建立主键, 接下来再建一张子表(<code>tab_child</code>)：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`tab_child`</span> (  </div><div class="line">    <span class="string">`id`</span> <span class="built_in">INT</span>(<span class="number">10</span>) <span class="keyword">UNSIGNED</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,  </div><div class="line">    <span class="string">`col`</span> <span class="built_in">INT</span>(<span class="number">10</span>) <span class="keyword">UNSIGNED</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,  </div><div class="line">    <span class="string">`col2`</span> <span class="built_in">INT</span>(<span class="number">10</span>) <span class="keyword">UNSIGNED</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>, </div><div class="line">    PRIMARY <span class="keyword">KEY</span> (<span class="string">`id`</span>)  </div><div class="line">)  </div><div class="line"><span class="keyword">COLLATE</span>=<span class="string">'utf8_general_ci'</span>  </div><div class="line"><span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span></div></pre></td></tr></table></figure></p>
<p>再进行子表<code>col</code>关联父表<code>t_second</code>字段，发现失败。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> <span class="string">`tab_child`</span> <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> <span class="string">`FK_tab_child_tab_father`</span> FOREIGN <span class="keyword">KEY</span> (<span class="string">`col`</span>) </div><div class="line"><span class="keyword">REFERENCES</span> <span class="string">`tab_father`</span> (<span class="string">`t_second`</span>) <span class="keyword">ON</span> <span class="keyword">UPDATE</span> <span class="keyword">CASCADE</span> <span class="keyword">ON</span> <span class="keyword">DELETE</span> <span class="keyword">CASCADE</span>;</div><div class="line">[Err] 1215 - Cannot add foreign key constraint</div></pre></td></tr></table></figure></p>
<p>为<code>tab_father</code>添加一个索引再执行外键语句 -&gt;(成功)：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> <span class="string">`tab_father`</span> <span class="keyword">ADD</span> <span class="keyword">INDEX</span> <span class="string">`t_second`</span> (<span class="string">`t_second`</span>);</div></pre></td></tr></table></figure></p>
<h5 id="注：这个时候，我们去看子表的索引，会发现，其实在创建外键的同时，mysql默认给子表也添加了一个索引。"><a href="#注：这个时候，我们去看子表的索引，会发现，其实在创建外键的同时，mysql默认给子表也添加了一个索引。" class="headerlink" title="注：这个时候，我们去看子表的索引，会发现，其实在创建外键的同时，mysql默认给子表也添加了一个索引。"></a><span style="color:red; text-decoration:underline;">注：这个时候，我们去看子表的索引，会发现，其实在创建外键的同时，mysql默认给子表也添加了一个索引。</span></h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">+<span class="comment">------------+-------------+------------+</span></div><div class="line">| TABLE_NAME | COLUMN_NAME | COLUMN_KEY |</div><div class="line">+<span class="comment">------------+-------------+------------+</span></div><div class="line">| tab_child  | col         | MUL        |</div><div class="line">+<span class="comment">------------+-------------+------------+</span></div></pre></td></tr></table></figure>
<p>我们再创建一个子表tab_child2：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`tab_child2`</span> (  </div><div class="line">    <span class="string">`id`</span> <span class="built_in">INT</span>(<span class="number">10</span>) <span class="keyword">UNSIGNED</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,  </div><div class="line">    <span class="string">`col`</span> <span class="built_in">INT</span>(<span class="number">10</span>) <span class="keyword">UNSIGNED</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,  </div><div class="line">    <span class="string">`col2`</span> <span class="built_in">INT</span>(<span class="number">10</span>) <span class="keyword">UNSIGNED</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>, </div><div class="line">    PRIMARY <span class="keyword">KEY</span> (<span class="string">`id`</span>)  </div><div class="line">)  </div><div class="line"><span class="keyword">COLLATE</span>=<span class="string">'utf8_general_ci'</span>  </div><div class="line"><span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span></div></pre></td></tr></table></figure></p>
<p>删掉<code>tab_child</code>的外键，再给<code>tab_child2</code>做<code>col2</code>关联父表<code>t_first</code>字段，发现失败。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> tab_child <span class="keyword">drop</span> foreign <span class="keyword">key</span> FK_tab_child_tab_father;</div><div class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> <span class="string">`tab_child2`</span> <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> <span class="string">`FK_tab_child_tab_father`</span> FOREIGN <span class="keyword">KEY</span> (<span class="string">`col2`</span>) </div><div class="line"><span class="keyword">REFERENCES</span> <span class="string">`tab_father`</span> (<span class="string">`t_first`</span>) <span class="keyword">ON</span> <span class="keyword">UPDATE</span> <span class="keyword">CASCADE</span> <span class="keyword">ON</span> <span class="keyword">DELETE</span> <span class="keyword">CASCADE</span>;</div><div class="line">[Err] 1215 - Cannot add foreign key constraint</div></pre></td></tr></table></figure></p>
<p>笔者朋友就是在这里被卡住的，为什么已经drop了外键，但是却报错了呢，原因同之前一样，因为父表的t_first，未建立索引，建立索引后成功。<br>笔者朋友还遇到一种情况：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[Err] 1061 - Duplicate key name 'FK_tab_child_tab_father'</div></pre></td></tr></table></figure></p>
<p>这种也令人费解，同样的也是为什么已经drop了外键，但是也报错了呢，这个是因为，在建立外键时，<br>子表被自动加了<code>FK_tab_child_tab_father</code>这个索引名称导致后面在建立外键时，采用同一个名称，所以会报错。<br><span style="color:red; text-decoration:underline;">这个时候，可以修改外键名称，或删除之前没用的索引，或在最开始创建一个字段索引(注: 增加外键是无则加之。)，这样的办法来进行增加外键。</span><br>那么，为什么mysql会在创立外键的时间，给默认增加一个索引呢？<br>主要原因就在于查询性能。<br>父子表之间在进行外键检查时，需要一条一条每条必查地校验，而且在对父表的SELECT操作时，为了避免产出数据不一致，<br>使用的是一致性锁定读(SELECT …… LOCK IN SHARE MODE)，主动加一个S锁阻塞其他的修改操作。如果没有索引，<br>对于大一点的表而言那效率就非常低下。参考文档：<a href="https://dev.mysql.com/doc/refman/5.7/en/create-table-foreign-keys.html" target="_blank" rel="external">https://dev.mysql.com/doc/refman/5.7/en/create-table-foreign-keys.html</a></p>
<p>那为什么子表可以隐式地创建索引而父表需要显式地创建(主表没有索引报错)？</p>
<ul>
<li>笔者理解为是mysql的执行顺序问题(性能问题)。<br>  检查父表关联字段有没有创建可使用的有效索引<br>  检查子表父表字段属性的一致性，包括数据类型、长度、字符编码等<br>  检查子表外键字段是否创建索引(无则创建，创建名称唯一)<br>  检查子表数据是否关联父表记录</li>
<li>可能会存在其他原因：<br>  父表权限(暗示拥有创建字表的权限)<br>  操作权限(外键是基于字表上工作)<br>或者这是mysql的设计者觉得这是一种比较合理的方式吧。</li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;昨晚被朋友问到一个有关mysql外键的问题,问我删除外键再重新创建另一张表的外键，会提示key值重复，一下子问懵了，&lt;br&gt;潜意识告诉我不应该，但是自己做了一下操作确实如此，最后发现是建立了索引的缘故。故，在此记录一下，写一下关于我的理解。&lt;br&gt;既然做记录，这边就简述一下外键：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;如果一张表中有一个非主键的字段指向了别一张表中的主键，就将该字段叫做外键。&lt;/li&gt;
&lt;li&gt;1.对子表(外键所在的表)的作用：子表在进行写操作的时候，如果外键字段在父表中找不到对应的匹配，操作就会失败。&lt;/li&gt;
&lt;li&gt;2.对父表的作用：对父表的主键字段进行删和改时，如果对应的主键在子表中被引用，操作就会失败。&lt;/li&gt;
&lt;li&gt;外键的定制作用：&lt;br&gt;  =&amp;gt; district：严格模式(默认), 父表不能删除或更新一个被子表引用的记录。&lt;br&gt;  =&amp;gt; cascade：级联模式, 父表操作后，子表关联的数据也跟着一起操作。&lt;br&gt;  =&amp;gt; set null：置空模式,前提外键字段允许为NLL,  父表操作后，子表对应的字段被置空。&lt;/li&gt;
&lt;li&gt;使用外键的前提：&lt;br&gt;  =&amp;gt; 表储存引擎必须是innodb，否则创建的外键无约束效果。&lt;br&gt;  =&amp;gt; 外键的列类型必须与父表的主键类型完全一致。&lt;br&gt;  =&amp;gt; 外键的名字不能重复。&lt;br&gt;  =&amp;gt; 已经存在数据的字段被设为外键时，必须保证字段中的数据与父表的主键数据对应起来。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;其实在现在的并发系统中，因为限制的原因，采用外键的机会个人觉得不会很多.(笔者参与的几个项目均未采用外键)&lt;br&gt;接下来，我们做一个验证：&lt;br&gt;
    
    </summary>
    
      <category term="mysql" scheme="http://bin.bloggao.cn/categories/mysql/"/>
    
    
      <category term="mysql" scheme="http://bin.bloggao.cn//tags/mysql/"/>
    
  </entry>
  
  <entry>
    <title>Requests对摘要认证的处理</title>
    <link href="http://bin.bloggao.cn/2017/12/21/python_sip/"/>
    <id>http://bin.bloggao.cn/2017/12/21/python_sip/</id>
    <published>2017-12-21T10:25:50.000Z</published>
    <updated>2017-12-25T10:50:40.444Z</updated>
    
    <content type="html"><![CDATA[<p>许多 web 服务都需要身份认证，并且也有多种不同的认证类型。<br>下面笔者着重说一下摘要认证以及python包Requests对摘要认证的处理。<br>首先，Requests对摘要认证其实是开箱即用的。<br>如下：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> requests.auth <span class="keyword">import</span> HTTPDigestAuth</div><div class="line">url = <span class="string">'http://digest.cereson.cn/auth/index.php'</span></div><div class="line">requests.get(url, auth=HTTPDigestAuth(<span class="string">'user'</span>, <span class="string">'passwd'</span>))</div></pre></td></tr></table></figure></p>
<p>接下来说一下什么是摘要认证：<br>首先摘要认证被设计用来弥补基本认证的缺点。<br>摘要认证基于请求-响应（challenge-response）模式，<br>而且使用了哈希加密算法（常用为MD5），从而某些程度上解决了基本认证安全性的问题。<br>服务器返回的初始401响应的www认证头（WWW-Authenticate header）中多出了一个称为nonce的随机数的字段。<br>服务端保证每个401响应中的nonce值唯一。如：<br><code>Authorization: Digest username=&quot;admin&quot;, realm=&quot;HiPER&quot;</code></p>
<p>接下来的客户端响应中将包含由用户名、密码、nonce和其他信息组成的数据的哈希值（如使用MD5加密）。<br>所有被加密的数据服务端也具有，因此服务端执行同样加密过程。如果二者一致则认证成功。<br>因为如MD5等哈希加密算法是不可逆的，因此用户名密码明文无法被窃听破解。<br>因为服务器对同一个nonce的请求只接受一次客户端请求，从而能避免重放攻击。<br>但是，digest的安全性也有缺点：</p>
<ul>
<li>只有密码密码被加密，而客户端最终请求的被保护资源是明文传送的，可被窃听</li>
<li>客户端无法确认服务端的正确身份，缺少对服务端的认证方式</li>
<li>近年来，随着计算机性能的提高等因素，传统高强度加密算法的破解已成可能。而MD5更是已有破解方法。<a id="more"></a>
</li>
</ul>
<h5 id="通俗点说："><a href="#通俗点说：" class="headerlink" title="通俗点说："></a>通俗点说：</h5><p>客户端首次向服务器发送HTTP请求，服务器返回401（未授权）响应进行挑战。<br>401消息的头里带有WWW-Authenticate消息头，其中包含挑战摘要的随机参数nonce。<br>客户端收到401后，将用户名密码和挑战信息用MD5加密形成认证鉴权头，重新发送给服务器，服务器对认证鉴权头进行验证，<br>如果认证成功则返回200 OK并返回操作的Cookie,在后续的访问中客户端只需要使用该分配的Cookie进行服务操作即可。</p>
<p>服务器的401未授权挑战WWW-Authenticate消息头语法：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">* challenge        = <span class="string">"Digest"</span> digest-challenge</div><div class="line">* digest-challenge = <span class="number">1</span><span class="comment">#( realm | [ domain ] | nonce | [opaque] |[stale] | [algorithm] | [qop-options] | [auth-param] )</span></div><div class="line">* domain            = <span class="string">"domain"</span> <span class="string">"="</span> &lt;<span class="string">"&gt; URI ( 1*SP URI ) &lt;"</span>&gt;</div><div class="line">* URI               = absoluteURI | abs_path</div><div class="line">* nonce             = <span class="string">"nonce"</span> <span class="string">"="</span> nonce-value</div><div class="line">* nonce-value       = quoted-string</div><div class="line">* opaque            = <span class="string">"opaque"</span> <span class="string">"="</span> quoted-string</div><div class="line">* stale             = <span class="string">"stale"</span> <span class="string">"="</span> ( <span class="string">"true"</span> | <span class="string">"false"</span> )</div><div class="line">* algorithm         = <span class="string">"algorithm"</span> <span class="string">"="</span> ( <span class="string">"MD5"</span> | <span class="string">"MD5-sess"</span> | token )</div><div class="line">* qop-options       = <span class="string">"qop"</span> <span class="string">"="</span> &lt;<span class="string">"&gt; 1#qop-value &lt;"</span>&gt;</div><div class="line">* qop-value         = <span class="string">"auth"</span> | <span class="string">"auth-int"</span> | token</div></pre></td></tr></table></figure></p>
<h5 id="备注："><a href="#备注：" class="headerlink" title="备注："></a>备注：</h5><ul>
<li>realm：让客户知道使用哪个用户名和密码的字符串。不同的领域可能密码不一样。至少告诉用户是什么主机做认证，他可能会提示用哪个用户名登录，类似一个Email。</li>
<li>domain：一个URI列表，指示要保护的域。可能是一个列表。提示用户这些URI采用一样的认证。如果为空或忽略则为整个服务器。</li>
<li>nonce：随机字符串，每次401都不一样。跟算法有关。算法类似Base64加密：time-stamp H(time-stamp “:” ETag “:” private-key) 。time-stamp为服务器时钟，ETag为请求的Etag头。private-key为服务器知道的一个值。</li>
<li>opaque：服务器产生的由客户下去请求时原样返回。最好是Base64串或十六进制字符串。</li>
<li>auth-param：为扩展用的，现阶段忽略。</li>
</ul>
<p>摘要的计算方法：<br>客户端的挑战响应消息头语法：<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">credentials   =“Digest" digest-response</div><div class="line">digest-response=1#( username | realm | nonce | digest-uri</div><div class="line">               | response | [ algorithm ] | [cnonce] |</div><div class="line">               [opaque] | [message-qop] |</div><div class="line">                   [nonce-count]  | [auth-param] )</div><div class="line">username      ="username" "=" username-value</div><div class="line">username-value =quoted-string</div><div class="line">digest-uri    =“uri" "=" digest-uri-value</div><div class="line">digest-uri-value=request-uri   ; As specified by HTTP/1.1</div><div class="line">message-qop   =“qop" "=" qop-value</div><div class="line">cnonce        =“cnonce" "=" cnonce-value</div><div class="line">cnonce-value   =nonce-value</div><div class="line">nonce-count   =“nc" "=" nc-value</div><div class="line">nc-value       =8LHEX</div><div class="line">response      =“response" "=" request-digest</div><div class="line">request-digest=&lt;"&gt; 32LHEX &lt;"&gt;</div><div class="line">LHEX           ="0" | "1" | "2" | "3" |</div><div class="line">                   "4" | "5" | "6" | "7" |</div><div class="line">                   "8" | "9" | "a" | "b" |</div><div class="line">                   "c" | "d" | "e" | "f"</div></pre></td></tr></table></figure></p>
<table>
<thead>
<tr>
<th>参数名称</th>
<th style="text-align:left">说明</th>
<th style="text-align:center">必填</th>
<th style="text-align:center">数据类型</th>
<th style="text-align:center">备注</th>
</tr>
</thead>
<tbody>
<tr>
<td>username</td>
<td style="text-align:left">用户名</td>
<td style="text-align:center">Y</td>
<td style="text-align:center">xsd:string</td>
<td style="text-align:center">客户端ID或者VcuId</td>
</tr>
<tr>
<td>realm</td>
<td style="text-align:left">用户域</td>
<td style="text-align:center">Y</td>
<td style="text-align:center">xsd:string</td>
<td style="text-align:center">告知用户使用哪个域的用户名密码登录。这里如“bj.hyc.cn”</td>
</tr>
<tr>
<td>nonce</td>
<td style="text-align:left">摘要质询参数</td>
<td style="text-align:center">Y</td>
<td style="text-align:center">xsd:string</td>
<td style="text-align:center">返回请求一响应中的参数nonce</td>
</tr>
<tr>
<td>uri</td>
<td style="text-align:left">访问路径</td>
<td style="text-align:center">Y</td>
<td style="text-align:center">xsd:string</td>
<td style="text-align:center">请求的URI</td>
</tr>
<tr>
<td>qop</td>
<td style="text-align:left">保护质量</td>
<td style="text-align:center">Y</td>
<td style="text-align:center">xsd:string</td>
<td style="text-align:center">auth：鉴权，不对消息体做完整性验证。</td>
</tr>
<tr>
<td></td>
<td style="text-align:left"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center">auth-int：鉴权并需要对消息体做摘要，保证消息完整性。</td>
</tr>
<tr>
<td></td>
<td style="text-align:left"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center">注册过程使用auth。</td>
</tr>
<tr>
<td>nc</td>
<td style="text-align:left">nonce计数参数</td>
<td style="text-align:center">Y</td>
<td style="text-align:center">xsd:string</td>
<td style="text-align:center">客户端请求的十六进制计数，以00000001开始，每次请求加1，目的是防止重放攻击。</td>
</tr>
<tr>
<td>cnonce</td>
<td style="text-align:left">客户端nonce值</td>
<td style="text-align:center">Y</td>
<td style="text-align:center">xsd:string</td>
<td style="text-align:center">客户端用来鉴定服务器的摘要质询参数，本版本暂不实现客户端对服务器的认证</td>
</tr>
<tr>
<td>response</td>
<td style="text-align:left">响应值</td>
<td style="text-align:center">Y</td>
<td style="text-align:center">xsd:string</td>
<td style="text-align:center">对请求一中401响应的参数采用MD5算法做摘要计算的结果</td>
</tr>
<tr>
<td>opaque</td>
<td style="text-align:left">会话标识</td>
<td style="text-align:center">Y</td>
<td style="text-align:center">xsd:string</td>
<td style="text-align:center">返回服务器原值</td>
</tr>
</tbody>
</table>
<p>response参数计算算法：<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">response=&lt;"&gt; &lt; KD ( H(A1), unq(nonce-value)</div><div class="line">":" nc-value</div><div class="line">":" unq(cnonce-value)</div><div class="line">":" unq(qop-value)</div><div class="line">":" H(A2)</div><div class="line">) &lt;"&gt;</div><div class="line">A1=unq(username-value) ":" unq(realm-value) ":" passwd</div><div class="line">如果qop等于auth，A2=Method ":" digest-uri-value</div><div class="line">如果qop等于auth-int，A2=Method ":" digest-uri-value ":" H(entity-body)</div><div class="line">其中：</div><div class="line">1)  H(data)=MD5(data)。</div><div class="line">2)  KD(secret, data)=H(concat(secret, ":", data))。</div><div class="line">3)  unq(X)代表去掉X前后的引号。</div><div class="line">4)  Method=GET或者POST。</div><div class="line">5)  entity-body代表HTTP请求的消息体。</div><div class="line">6)  passwd=key。</div></pre></td></tr></table></figure></p>
<p>服务器在收到客户端的挑战响应消息后，根据Authorization消息头中的username参数，<br>取出对应的key和key的有效期，然后使用和客户端相同的计算方法，<br>对Authorization消息头中的参数进行摘要计算，将计算结果与response值进行比较，<br>相同则鉴权成功，返回200 OK响应，不同则鉴权失败，重新返回401 Unauthorized响应，格式与请求一的401响应相同。</p>
<p>rspauth参数计算算法：<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">rspauth=&lt;"&gt; &lt; KD(H(A1),unq(nextnonce-value)</div><div class="line">":"nc-value</div><div class="line">":"unq(cnonce-value)</div><div class="line">":"unq(qop-value)</div><div class="line">":"H(A2)</div><div class="line">)&lt;"&gt;</div><div class="line">A1=unq(username-value)":"unq(realm-value)":"passwd</div><div class="line">如果qop等于auth，A2=":" digest-uri-value</div><div class="line">如果qop等于auth-int，A2=":" digest-uri-value ":" H(entity-body)</div><div class="line">其中：</div><div class="line">1) H(data)=MD5(data)。</div><div class="line">2) KD(secret, data)=H(concat(secret, ":", data))。</div><div class="line">3) unq(X)代表去掉X前后的引号。</div><div class="line">4) entity-body代表HTTP请求的消息体。</div><div class="line">5) passwd=key。</div></pre></td></tr></table></figure></p>
<h5 id="示例："><a href="#示例：" class="headerlink" title="示例："></a>示例：</h5><p>首次接入进行挑战过程，假设操作为登陆接(实际可能不存在该接口，此处只是举例说明)，用户名为abc@123.com 密码为111111.</p>
<p>请求：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">GET /login HTTP/<span class="number">1.1</span></div><div class="line">Host: <span class="number">123.</span>com</div></pre></td></tr></table></figure></p>
<p>应答401挑战：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">HTTP/<span class="number">1.1</span> <span class="number">401</span> Unauthorized </div><div class="line">WWW-Authenticate:Digest realm=<span class="string">"123.com"</span>,nonce=<span class="string">"30373034323033393432343638323539"</span>,qop=auth</div></pre></td></tr></table></figure></p>
<p>认证请求：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">GET /login HTTP/<span class="number">1.1</span></div><div class="line">Host: <span class="number">123.</span>com</div><div class="line">Authorization:Digest realm=<span class="string">"123.com"</span>,nonce=<span class="string">"30373034323033393432343638323539"</span>,username=<span class="string">"abc@123.com"</span>,qop=auth,uri=<span class="string">"/banklogin"</span>,response=<span class="string">"7a086bb798e81d0c815fc3fc32238bc6"</span>,cnonce=<span class="string">"b1ce32121cb97d8dde121f3e8421288e"</span>,nc=<span class="number">00000001</span>, algorithm=<span class="string">"MD5"</span></div><div class="line">Date: Sun,<span class="number">4</span> Jul <span class="number">2010</span> <span class="number">12</span>:<span class="number">39</span>:<span class="number">43</span> GMT</div></pre></td></tr></table></figure></p>
<p>成功响应：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">HTTP/<span class="number">1.0</span> <span class="number">200</span> OK </div><div class="line">Server: webserver</div><div class="line">ContentType:application/json;charset=utf8</div><div class="line">Set-Cookie: JSESSIONID=<span class="number">07205746E416581</span>AADD6BBAFB053804C</div></pre></td></tr></table></figure></p>
<p>只需用在后续的请求中携带Cookie即可。</p>
<p>笔者在这也翻了一下Requests对于摘要认证的处理,方便大家参考：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">HTTPDigestAuth</span><span class="params">(AuthBase)</span>:</span></div><div class="line">    <span class="string">"""Attaches HTTP Digest Authentication to the given Request object."""</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, username, password)</span>:</span></div><div class="line">        self.username = username</div><div class="line">        self.password = password</div><div class="line">        <span class="comment"># Keep state in per-thread local storage</span></div><div class="line">        self._thread_local = threading.local()</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">init_per_thread_state</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="comment"># Ensure state is initialized just once per-thread</span></div><div class="line">        <span class="keyword">if</span> <span class="keyword">not</span> hasattr(self._thread_local, <span class="string">'init'</span>):</div><div class="line">            self._thread_local.init = <span class="keyword">True</span></div><div class="line">            self._thread_local.last_nonce = <span class="string">''</span></div><div class="line">            self._thread_local.nonce_count = <span class="number">0</span></div><div class="line">            self._thread_local.chal = &#123;&#125;</div><div class="line">            self._thread_local.pos = <span class="keyword">None</span></div><div class="line">            self._thread_local.num_401_calls = <span class="keyword">None</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">build_digest_header</span><span class="params">(self, method, url)</span>:</span></div><div class="line">        <span class="string">"""</span></div><div class="line">        :rtype: str</div><div class="line">        """</div><div class="line"></div><div class="line">        realm = self._thread_local.chal[<span class="string">'realm'</span>]</div><div class="line">        nonce = self._thread_local.chal[<span class="string">'nonce'</span>]</div><div class="line">        qop = self._thread_local.chal.get(<span class="string">'qop'</span>)</div><div class="line">        algorithm = self._thread_local.chal.get(<span class="string">'algorithm'</span>)</div><div class="line">        opaque = self._thread_local.chal.get(<span class="string">'opaque'</span>)</div><div class="line">        hash_utf8 = <span class="keyword">None</span></div><div class="line"></div><div class="line">        <span class="keyword">if</span> algorithm <span class="keyword">is</span> <span class="keyword">None</span>:</div><div class="line">            _algorithm = <span class="string">'MD5'</span></div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            _algorithm = algorithm.upper()</div><div class="line">        <span class="comment"># lambdas assume digest modules are imported at the top level</span></div><div class="line">        <span class="keyword">if</span> _algorithm == <span class="string">'MD5'</span> <span class="keyword">or</span> _algorithm == <span class="string">'MD5-SESS'</span>:</div><div class="line">            <span class="function"><span class="keyword">def</span> <span class="title">md5_utf8</span><span class="params">(x)</span>:</span></div><div class="line">                <span class="keyword">if</span> isinstance(x, str):</div><div class="line">                    x = x.encode(<span class="string">'utf-8'</span>)</div><div class="line">                <span class="keyword">return</span> hashlib.md5(x).hexdigest()</div><div class="line">            hash_utf8 = md5_utf8</div><div class="line">        <span class="keyword">elif</span> _algorithm == <span class="string">'SHA'</span>:</div><div class="line">            <span class="function"><span class="keyword">def</span> <span class="title">sha_utf8</span><span class="params">(x)</span>:</span></div><div class="line">                <span class="keyword">if</span> isinstance(x, str):</div><div class="line">                    x = x.encode(<span class="string">'utf-8'</span>)</div><div class="line">                <span class="keyword">return</span> hashlib.sha1(x).hexdigest()</div><div class="line">            hash_utf8 = sha_utf8</div><div class="line"></div><div class="line">        KD = <span class="keyword">lambda</span> s, d: hash_utf8(<span class="string">"%s:%s"</span> % (s, d))</div><div class="line"></div><div class="line">        <span class="keyword">if</span> hash_utf8 <span class="keyword">is</span> <span class="keyword">None</span>:</div><div class="line">            <span class="keyword">return</span> <span class="keyword">None</span></div><div class="line"></div><div class="line">        <span class="comment"># XXX not implemented yet</span></div><div class="line">        entdig = <span class="keyword">None</span></div><div class="line">        p_parsed = urlparse(url)</div><div class="line">        <span class="comment">#: path is request-uri defined in RFC 2616 which should not be empty</span></div><div class="line">        path = p_parsed.path <span class="keyword">or</span> <span class="string">"/"</span></div><div class="line">        <span class="keyword">if</span> p_parsed.query:</div><div class="line">            path += <span class="string">'?'</span> + p_parsed.query</div><div class="line"></div><div class="line">        A1 = <span class="string">'%s:%s:%s'</span> % (self.username, realm, self.password)</div><div class="line">        A2 = <span class="string">'%s:%s'</span> % (method, path)</div><div class="line"></div><div class="line">        HA1 = hash_utf8(A1)</div><div class="line">        HA2 = hash_utf8(A2)</div><div class="line"></div><div class="line">        <span class="keyword">if</span> nonce == self._thread_local.last_nonce:</div><div class="line">            self._thread_local.nonce_count += <span class="number">1</span></div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            self._thread_local.nonce_count = <span class="number">1</span></div><div class="line">        ncvalue = <span class="string">'%08x'</span> % self._thread_local.nonce_count</div><div class="line">        s = str(self._thread_local.nonce_count).encode(<span class="string">'utf-8'</span>)</div><div class="line">        s += nonce.encode(<span class="string">'utf-8'</span>)</div><div class="line">        s += time.ctime().encode(<span class="string">'utf-8'</span>)</div><div class="line">        s += os.urandom(<span class="number">8</span>)</div><div class="line"></div><div class="line">        cnonce = (hashlib.sha1(s).hexdigest()[:<span class="number">16</span>])</div><div class="line">        <span class="keyword">if</span> _algorithm == <span class="string">'MD5-SESS'</span>:</div><div class="line">            HA1 = hash_utf8(<span class="string">'%s:%s:%s'</span> % (HA1, nonce, cnonce))</div><div class="line"></div><div class="line">        <span class="keyword">if</span> <span class="keyword">not</span> qop:</div><div class="line">            respdig = KD(HA1, <span class="string">"%s:%s"</span> % (nonce, HA2))</div><div class="line">        <span class="keyword">elif</span> qop == <span class="string">'auth'</span> <span class="keyword">or</span> <span class="string">'auth'</span> <span class="keyword">in</span> qop.split(<span class="string">','</span>):</div><div class="line">            noncebit = <span class="string">"%s:%s:%s:%s:%s"</span> % (</div><div class="line">                nonce, ncvalue, cnonce, <span class="string">'auth'</span>, HA2</div><div class="line">                )</div><div class="line">            respdig = KD(HA1, noncebit)</div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            <span class="comment"># XXX handle auth-int.</span></div><div class="line">            <span class="keyword">return</span> <span class="keyword">None</span></div><div class="line"></div><div class="line">        self._thread_local.last_nonce = nonce</div><div class="line"></div><div class="line">        <span class="comment"># XXX should the partial digests be encoded too?</span></div><div class="line">        base = <span class="string">'username="%s", realm="%s", nonce="%s", uri="%s", '</span> \</div><div class="line">               <span class="string">'response="%s"'</span> % (self.username, realm, nonce, path, respdig)</div><div class="line">        <span class="keyword">if</span> opaque:</div><div class="line">            base += <span class="string">', opaque="%s"'</span> % opaque</div><div class="line">        <span class="keyword">if</span> algorithm:</div><div class="line">            base += <span class="string">', algorithm="%s"'</span> % algorithm</div><div class="line">        <span class="keyword">if</span> entdig:</div><div class="line">            base += <span class="string">', digest="%s"'</span> % entdig</div><div class="line">        <span class="keyword">if</span> qop:</div><div class="line">            base += <span class="string">', qop="auth", nc=%s, cnonce="%s"'</span> % (ncvalue, cnonce)</div><div class="line"></div><div class="line">        <span class="keyword">return</span> <span class="string">'Digest %s'</span> % (base)</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">handle_redirect</span><span class="params">(self, r, **kwargs)</span>:</span></div><div class="line">        <span class="string">"""Reset num_401_calls counter on redirects."""</span></div><div class="line">        <span class="keyword">if</span> r.is_redirect:</div><div class="line">            self._thread_local.num_401_calls = <span class="number">1</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">handle_401</span><span class="params">(self, r, **kwargs)</span>:</span></div><div class="line">        <span class="string">"""</span></div><div class="line">        Takes the given response and tries digest-auth, if needed.</div><div class="line"></div><div class="line">        :rtype: requests.Response</div><div class="line">        """</div><div class="line"></div><div class="line">        <span class="keyword">if</span> self._thread_local.pos <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span>:</div><div class="line">            <span class="comment"># Rewind the file position indicator of the body to where</span></div><div class="line">            <span class="comment"># it was to resend the request.</span></div><div class="line">            r.request.body.seek(self._thread_local.pos)</div><div class="line">        s_auth = r.headers.get(<span class="string">'www-authenticate'</span>, <span class="string">''</span>)</div><div class="line"></div><div class="line">        <span class="keyword">if</span> <span class="string">'digest'</span> <span class="keyword">in</span> s_auth.lower() <span class="keyword">and</span> self._thread_local.num_401_calls &lt; <span class="number">2</span>:</div><div class="line"></div><div class="line">            self._thread_local.num_401_calls += <span class="number">1</span></div><div class="line">            pat = re.compile(<span class="string">r'digest '</span>, flags=re.IGNORECASE)</div><div class="line">            self._thread_local.chal = parse_dict_header(pat.sub(<span class="string">''</span>, s_auth, count=<span class="number">1</span>))</div><div class="line"></div><div class="line">            <span class="comment"># Consume content and release the original connection</span></div><div class="line">            <span class="comment"># to allow our new request to reuse the same one.</span></div><div class="line">            r.content</div><div class="line">            r.close()</div><div class="line">            prep = r.request.copy()</div><div class="line">            extract_cookies_to_jar(prep._cookies, r.request, r.raw)</div><div class="line">            prep.prepare_cookies(prep._cookies)</div><div class="line"></div><div class="line">            prep.headers[<span class="string">'Authorization'</span>] = self.build_digest_header(</div><div class="line">                prep.method, prep.url)</div><div class="line">            _r = r.connection.send(prep, **kwargs)</div><div class="line">            _r.history.append(r)</div><div class="line">            _r.request = prep</div><div class="line"></div><div class="line">            <span class="keyword">return</span> _r</div><div class="line"></div><div class="line">        self._thread_local.num_401_calls = <span class="number">1</span></div><div class="line">        <span class="keyword">return</span> r</div></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;许多 web 服务都需要身份认证，并且也有多种不同的认证类型。&lt;br&gt;下面笔者着重说一下摘要认证以及python包Requests对摘要认证的处理。&lt;br&gt;首先，Requests对摘要认证其实是开箱即用的。&lt;br&gt;如下：&lt;br&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; requests.auth &lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; HTTPDigestAuth&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;url = &lt;span class=&quot;string&quot;&gt;&#39;http://digest.cereson.cn/auth/index.php&#39;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;requests.get(url, auth=HTTPDigestAuth(&lt;span class=&quot;string&quot;&gt;&#39;user&#39;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;passwd&#39;&lt;/span&gt;))&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;接下来说一下什么是摘要认证：&lt;br&gt;首先摘要认证被设计用来弥补基本认证的缺点。&lt;br&gt;摘要认证基于请求-响应（challenge-response）模式，&lt;br&gt;而且使用了哈希加密算法（常用为MD5），从而某些程度上解决了基本认证安全性的问题。&lt;br&gt;服务器返回的初始401响应的www认证头（WWW-Authenticate header）中多出了一个称为nonce的随机数的字段。&lt;br&gt;服务端保证每个401响应中的nonce值唯一。如：&lt;br&gt;&lt;code&gt;Authorization: Digest username=&amp;quot;admin&amp;quot;, realm=&amp;quot;HiPER&amp;quot;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;接下来的客户端响应中将包含由用户名、密码、nonce和其他信息组成的数据的哈希值（如使用MD5加密）。&lt;br&gt;所有被加密的数据服务端也具有，因此服务端执行同样加密过程。如果二者一致则认证成功。&lt;br&gt;因为如MD5等哈希加密算法是不可逆的，因此用户名密码明文无法被窃听破解。&lt;br&gt;因为服务器对同一个nonce的请求只接受一次客户端请求，从而能避免重放攻击。&lt;br&gt;但是，digest的安全性也有缺点：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;只有密码密码被加密，而客户端最终请求的被保护资源是明文传送的，可被窃听&lt;/li&gt;
&lt;li&gt;客户端无法确认服务端的正确身份，缺少对服务端的认证方式&lt;/li&gt;
&lt;li&gt;近年来，随着计算机性能的提高等因素，传统高强度加密算法的破解已成可能。而MD5更是已有破解方法。
    
    </summary>
    
      <category term="python" scheme="http://bin.bloggao.cn/categories/python/"/>
    
    
      <category term="python" scheme="http://bin.bloggao.cn//tags/python/"/>
    
      <category term="http" scheme="http://bin.bloggao.cn//tags/http/"/>
    
  </entry>
  
  <entry>
    <title>如何在Python里使用FTP</title>
    <link href="http://bin.bloggao.cn/2017/12/20/python_ftp/"/>
    <id>http://bin.bloggao.cn/2017/12/20/python_ftp/</id>
    <published>2017-12-20T07:57:15.000Z</published>
    <updated>2017-12-20T10:04:56.730Z</updated>
    
    <content type="html"><![CDATA[<p>Python作为一款集包大成的语言，自然必不可少ftplib，而ftplib模块就定义了FTP类用于上传或下载文件。</p>
<h5 id="以下是FTP的常用函数"><a href="#以下是FTP的常用函数" class="headerlink" title="以下是FTP的常用函数:"></a>以下是FTP的常用函数:</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">ftp=FTP() <span class="comment">#设置ftp变量</span></div><div class="line">ftp.set_debuglevel(<span class="number">2</span>)  <span class="comment">#开启调试级别2</span></div><div class="line">ftp.connect(<span class="string">"IP"</span>,<span class="string">"port"</span>)  <span class="comment">#连接的ftp 地址、端口</span></div><div class="line">ftp.login(<span class="string">"user"</span>,<span class="string">"passwd"</span>)  <span class="comment">#ftp的用户名、密码</span></div><div class="line">ftp.cmd(<span class="string">"liecol/test"</span>)  <span class="comment">#进入ftp远程目录</span></div><div class="line">bufsize=<span class="number">1024</span>  <span class="comment">#设置的缓冲区大小</span></div><div class="line">file_handle=open(<span class="string">"test.py"</span>,<span class="string">"wb"</span>).write <span class="comment">#以写模式在本地打开文件</span></div><div class="line">ftp.retrbinaly(<span class="string">"RETR test.py"</span>,file_handle,bufsize) <span class="comment">#接收ftp服务器上文件并写入本地文件</span></div><div class="line">ftp.set_debuglevel(<span class="number">0</span>)  <span class="comment">#关闭调试模式</span></div><div class="line">ftp.quit()  <span class="comment">#退出ftp</span></div><div class="line"></div><div class="line">ftp.cwd(path)  <span class="comment">#设置FTP操作的路径</span></div><div class="line">ftp.dir()   <span class="comment">#显示ftp目录下的所有信息</span></div><div class="line">ftp.nlst()  <span class="comment">#获取目录下的文件</span></div><div class="line">ftp.mkd(pathname)  <span class="comment">#新建ftp目录</span></div><div class="line">ftp.pwd()  <span class="comment">#返回当前所在位置</span></div><div class="line">ftp.rmd(dirname)  <span class="comment">#删除远程目录</span></div><div class="line">ftp.delete(filename)  <span class="comment">#删除远程文件</span></div><div class="line">ftp.rename(fromname, toname) <span class="comment">#修改ftp文件名字</span></div><div class="line">ftp.storbinaly(<span class="string">"STOR test.txt"</span>,file_handel,bufsize)  <span class="comment">#上传目标文件</span></div><div class="line">ftp.retrbinary(<span class="string">"RETR test.txt"</span>,file_handel,bufsize)  <span class="comment">#下载FTP文件</span></div></pre></td></tr></table></figure>
<a id="more"></a>
<p>笔者这边写了一个下载并删除30天前文件的Class(yymmdd)供大家参考：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">DownloadFtp</span>:</span></div><div class="line">    ftp = ftplib.FTP()</div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, host, port=<span class="string">'21'</span>)</span>:</span></div><div class="line">        <span class="comment"># self.ftp.set_debuglevel(2)</span></div><div class="line">        <span class="comment"># self.ftp.set_pasv(0)</span></div><div class="line">        self.ftp.connect(host, port)</div><div class="line">    </div><div class="line">    <span class="comment"># 登录</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">Login</span><span class="params">(self, username=<span class="string">''</span>, password=<span class="string">''</span>)</span>:</span></div><div class="line">        self.ftp.login(username, password)</div><div class="line"></div><div class="line">    <span class="comment"># 下载单文件</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">DownLoadFile</span><span class="params">(self, LocalFile, RemoteFile, dirpath=<span class="string">""</span>)</span>:</span></div><div class="line">        log.info(<span class="string">"DownLoad File: %s"</span> % RemoteFile)</div><div class="line">        <span class="keyword">try</span>:</div><div class="line">            self.ftp.cwd(dirpath)</div><div class="line">            bufsize = <span class="number">4096</span></div><div class="line">            file_handler = open(LocalFile, <span class="string">'wb'</span>)</div><div class="line">            self.ftp.retrbinary(<span class="string">"RETR %s"</span> % (RemoteFile), file_handler.write, bufsize)</div><div class="line">            self.ftp.set_debuglevel(<span class="number">0</span>)</div><div class="line">            file_handler.close()</div><div class="line">            <span class="keyword">return</span> <span class="keyword">True</span></div><div class="line">        <span class="keyword">except</span>:</div><div class="line">            <span class="keyword">return</span> <span class="keyword">False</span></div><div class="line">    </div><div class="line">    <span class="comment"># 删除文件</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">DelFile</span><span class="params">(self, FileName)</span>:</span></div><div class="line">        log.info(<span class="string">"Del File: %s"</span> % FileName)</div><div class="line">        self.ftp.delete(FileName)</div><div class="line"></div><div class="line">    <span class="comment"># 获取文件夹(未写包含文件夹情况)</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">DownLoadFileTree</span><span class="params">(self, LocalDir, RemoteDir, FtpDel=False)</span>:</span></div><div class="line">        <span class="keyword">if</span> os.path.isdir(LocalDir) == <span class="keyword">False</span>:</div><div class="line">            os.makedirs(LocalDir)</div><div class="line">        self.ftp.cwd(RemoteDir)</div><div class="line">        RemoteNames = self.ftp.nlst()</div><div class="line">        <span class="keyword">for</span> file <span class="keyword">in</span> RemoteNames:</div><div class="line">            Local = os.path.join(LocalDir, file)</div><div class="line">            time_format = datetime.today() + timedelta(<span class="number">-30</span>)</div><div class="line">            time_format = time_format.strftime(<span class="string">'%Y%m%d'</span>)</div><div class="line">            <span class="comment"># 未考虑文件名含其他8位数字情况</span></div><div class="line">            file_date = re.findall(<span class="string">r"[1-9]\d*|0"</span>, file)</div><div class="line">            time_yes = datetime.today() + timedelta(<span class="number">-1</span>)</div><div class="line">            time_today = time_yes.strftime(<span class="string">'%Y%m%d'</span>)</div><div class="line">            <span class="comment"># time_today = datetime.today().strftime('%Y%m%d')</span></div><div class="line">            <span class="keyword">if</span> file_date:</div><div class="line">                <span class="keyword">if</span> str(time_format) &gt;= file_date[<span class="number">0</span>] <span class="keyword">and</span> FtpDel:</div><div class="line">                    <span class="comment"># 未考虑dir情况</span></div><div class="line">                    re_del = self.DelFile(file)</div><div class="line">                <span class="keyword">elif</span> str(time_today) == file_date[<span class="number">0</span>]:</div><div class="line">                    self.DownLoadFile(Local, file)</div><div class="line">        self.ftp.cwd(<span class="string">".."</span>)</div><div class="line">        <span class="keyword">return</span></div><div class="line"></div><div class="line">    <span class="comment"># 获取文件信息</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">find</span><span class="params">(self,filename)</span>:</span></div><div class="line">        ftp_f_list = self.ftp.nlst()</div><div class="line">        <span class="keyword">if</span> filename <span class="keyword">in</span> ftp_f_list:</div><div class="line">            <span class="keyword">return</span> <span class="keyword">True</span></div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            <span class="keyword">return</span> <span class="keyword">False</span></div><div class="line"></div><div class="line">    <span class="comment"># 关闭</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">close</span><span class="params">(self)</span>:</span></div><div class="line">        self.ftp.quit()</div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Python作为一款集包大成的语言，自然必不可少ftplib，而ftplib模块就定义了FTP类用于上传或下载文件。&lt;/p&gt;
&lt;h5 id=&quot;以下是FTP的常用函数&quot;&gt;&lt;a href=&quot;#以下是FTP的常用函数&quot; class=&quot;headerlink&quot; title=&quot;以下是FTP的常用函数:&quot;&gt;&lt;/a&gt;以下是FTP的常用函数:&lt;/h5&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;15&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;16&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;17&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;18&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;19&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;20&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;21&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;ftp=FTP() &lt;span class=&quot;comment&quot;&gt;#设置ftp变量&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;ftp.set_debuglevel(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)  &lt;span class=&quot;comment&quot;&gt;#开启调试级别2&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;ftp.connect(&lt;span class=&quot;string&quot;&gt;&quot;IP&quot;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&quot;port&quot;&lt;/span&gt;)  &lt;span class=&quot;comment&quot;&gt;#连接的ftp 地址、端口&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;ftp.login(&lt;span class=&quot;string&quot;&gt;&quot;user&quot;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&quot;passwd&quot;&lt;/span&gt;)  &lt;span class=&quot;comment&quot;&gt;#ftp的用户名、密码&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;ftp.cmd(&lt;span class=&quot;string&quot;&gt;&quot;liecol/test&quot;&lt;/span&gt;)  &lt;span class=&quot;comment&quot;&gt;#进入ftp远程目录&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;bufsize=&lt;span class=&quot;number&quot;&gt;1024&lt;/span&gt;  &lt;span class=&quot;comment&quot;&gt;#设置的缓冲区大小&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;file_handle=open(&lt;span class=&quot;string&quot;&gt;&quot;test.py&quot;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&quot;wb&quot;&lt;/span&gt;).write &lt;span class=&quot;comment&quot;&gt;#以写模式在本地打开文件&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;ftp.retrbinaly(&lt;span class=&quot;string&quot;&gt;&quot;RETR test.py&quot;&lt;/span&gt;,file_handle,bufsize) &lt;span class=&quot;comment&quot;&gt;#接收ftp服务器上文件并写入本地文件&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;ftp.set_debuglevel(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;)  &lt;span class=&quot;comment&quot;&gt;#关闭调试模式&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;ftp.quit()  &lt;span class=&quot;comment&quot;&gt;#退出ftp&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;ftp.cwd(path)  &lt;span class=&quot;comment&quot;&gt;#设置FTP操作的路径&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;ftp.dir()   &lt;span class=&quot;comment&quot;&gt;#显示ftp目录下的所有信息&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;ftp.nlst()  &lt;span class=&quot;comment&quot;&gt;#获取目录下的文件&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;ftp.mkd(pathname)  &lt;span class=&quot;comment&quot;&gt;#新建ftp目录&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;ftp.pwd()  &lt;span class=&quot;comment&quot;&gt;#返回当前所在位置&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;ftp.rmd(dirname)  &lt;span class=&quot;comment&quot;&gt;#删除远程目录&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;ftp.delete(filename)  &lt;span class=&quot;comment&quot;&gt;#删除远程文件&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;ftp.rename(fromname, toname) &lt;span class=&quot;comment&quot;&gt;#修改ftp文件名字&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;ftp.storbinaly(&lt;span class=&quot;string&quot;&gt;&quot;STOR test.txt&quot;&lt;/span&gt;,file_handel,bufsize)  &lt;span class=&quot;comment&quot;&gt;#上传目标文件&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;ftp.retrbinary(&lt;span class=&quot;string&quot;&gt;&quot;RETR test.txt&quot;&lt;/span&gt;,file_handel,bufsize)  &lt;span class=&quot;comment&quot;&gt;#下载FTP文件&lt;/span&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="python" scheme="http://bin.bloggao.cn/categories/python/"/>
    
    
      <category term="python" scheme="http://bin.bloggao.cn//tags/python/"/>
    
      <category term="ftp" scheme="http://bin.bloggao.cn//tags/ftp/"/>
    
  </entry>
  
  <entry>
    <title>Requests 一款实用的python http库</title>
    <link href="http://bin.bloggao.cn/2017/12/13/python_requests/"/>
    <id>http://bin.bloggao.cn/2017/12/13/python_requests/</id>
    <published>2017-12-13T10:08:15.000Z</published>
    <updated>2017-12-14T10:59:26.764Z</updated>
    
    <content type="html"><![CDATA[<p>Requests 作为Python的一款实用型http库，一直深受好评。让人用完就不太想使用其他的http库。<br>对于http不太了解的开发，采用其他库，会经常出现安全隐患，性能差，不经意造轮子，代码冗余等病状，<br>所以，在笔者看来Requests还是比较友好和谐的一款http库。<br>接下来，我们来看一下Requests和非Requests的对比。</p>
<h5 id="非Requests："><a href="#非Requests：" class="headerlink" title="非Requests："></a>非Requests：</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> urllib2</div><div class="line"></div><div class="line">gh_url = <span class="string">'https://api.github.com'</span></div><div class="line"></div><div class="line">req = urllib2.Request(gh_url)</div><div class="line"></div><div class="line">password_manager = urllib2.HTTPPasswordMgrWithDefaultRealm()</div><div class="line">password_manager.add_password(<span class="keyword">None</span>, gh_url, <span class="string">'user'</span>, <span class="string">'pass'</span>)</div><div class="line"></div><div class="line">auth_manager = urllib2.HTTPBasicAuthHandler(password_manager)</div><div class="line">opener = urllib2.build_opener(auth_manager)</div><div class="line"></div><div class="line">urllib2.install_opener(opener)</div><div class="line"></div><div class="line">handler = urllib2.urlopen(req)</div><div class="line"></div><div class="line"><span class="keyword">print</span> handler.getcode()</div><div class="line"><span class="keyword">print</span> handler.headers.getheader(<span class="string">'content-type'</span>)</div><div class="line"></div><div class="line"><span class="comment"># ------</span></div><div class="line"><span class="comment"># 200</span></div><div class="line"><span class="comment"># 'application/json'</span></div></pre></td></tr></table></figure>
<h5 id="Requests："><a href="#Requests：" class="headerlink" title="Requests："></a>Requests：</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">r = requests.get(<span class="string">'https://api.github.com/users'</span>, auth=(<span class="string">'user'</span>, <span class="string">'pass'</span>))</div><div class="line"><span class="keyword">print</span> r.status_code</div><div class="line"><span class="comment"># ------</span></div><div class="line"><span class="comment"># 200</span></div></pre></td></tr></table></figure>
<p>对比后是不是感觉Requests非常的简洁明了。<br><a id="more"></a><br>Requests 完全满足目前的web需求,包括:</p>
<ul>
<li>Keep-Alive &amp; 连接池</li>
<li>国际化域名和 URL</li>
<li>带持久 Cookie 的会话</li>
<li>浏览器式的 SSL 认证</li>
<li>自动内容解码</li>
<li>基本/摘要式的身份认证</li>
<li>优雅的 key/value Cookie</li>
<li>自动解压</li>
<li>Unicode 响应体</li>
<li>HTTP(S) 代理支持</li>
<li>文件分块上传</li>
<li>流下载</li>
<li>连接超时</li>
<li>分块请求</li>
<li>支持 .netrc</li>
</ul>
<p>在这里，笔者不做安装介绍。主要介绍一下如何快速上手。</p>
<h5 id="发送请求："><a href="#发送请求：" class="headerlink" title="发送请求："></a>发送请求：</h5><p>GET, POST , PUT, DELETE, HEAD, OPTIONS 发送方式一应俱全。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">r = requests.get(<span class="string">'https://github.com/timeline.json'</span>)</div><div class="line">r = requests.post(<span class="string">"https://github.com/timeline.json"</span>)</div><div class="line">r = requests.put(<span class="string">"https://github.com/timeline.json"</span>)</div><div class="line">r = requests.delete(<span class="string">"https://github.com/timeline.json"</span>)</div><div class="line">r = requests.head(<span class="string">"https://github.com/timeline.json"</span>)</div><div class="line">r = requests.options(<span class="string">"https://github.com/timeline.json"</span>)</div></pre></td></tr></table></figure></p>
<h5 id="传递URL参数"><a href="#传递URL参数" class="headerlink" title="传递URL参数"></a>传递URL参数</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">payload = &#123;<span class="string">'key1'</span>: <span class="string">'value1'</span>, <span class="string">'key2'</span>: <span class="string">'value2'</span>&#125; <span class="comment">#可以采用dict的方式。</span></div><div class="line">r = requests.get(<span class="string">"http://httpbin.org/get"</span>, params=payload)</div></pre></td></tr></table></figure>
<p>解析出URL，我们就会发现URL已被正确编码：<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">print r.url</div><div class="line">http://httpbin.org/get?key2=value2&amp;key1=value1</div></pre></td></tr></table></figure></p>
<h5 id="响应内容"><a href="#响应内容" class="headerlink" title="响应内容"></a>响应内容</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> requests</div><div class="line">r = requests.get(<span class="string">'https://github.com/timeline.json'</span>)</div><div class="line"><span class="keyword">print</span> r.text</div><div class="line"><span class="string">u'[&#123;"repository":&#123;"open_issues":0,"url":"https://github.com/...</span></div></pre></td></tr></table></figure>
<p>Requests会自动解码来自服务器的内容,大多数unicode字符集都能被它无缝解码。</p>
<h5 id="JSON-响应内容"><a href="#JSON-响应内容" class="headerlink" title="JSON 响应内容"></a>JSON 响应内容</h5><p>Requests中也有一个内置的JSON解码器，可以帮助处理JSON数据：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">r = requests.get(<span class="string">'https://github.com/timeline.json'</span>)</div><div class="line">r.json() <span class="comment">#如果JSON解码失败,r.json()就会抛出一个异常。</span></div></pre></td></tr></table></figure></p>
<h5 id="定制请求头"><a href="#定制请求头" class="headerlink" title="定制请求头"></a>定制请求头</h5><p>和参数一样，可以采用dict的方式加入请求头数据。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">url = <span class="string">'https://github.com/timeline.json'</span></div><div class="line">headers = &#123;<span class="string">'user-agent'</span>: <span class="string">'my-app/0.0.1'</span>&#125;</div><div class="line">r = requests.get(url, headers=headers)</div></pre></td></tr></table></figure></p>
<p>注意：</p>
<ul>
<li>如果被重定向，定制的请求头就没啥用，会被删掉。</li>
<li>如果采用代理，同上。</li>
<li>Content-Length 会存在被改写的情况。</li>
</ul>
<h5 id="响应状态码"><a href="#响应状态码" class="headerlink" title="响应状态码"></a>响应状态码</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">r = requests.get(<span class="string">'https://github.com/timeline.json'</span>)</div><div class="line">r.status_code</div><div class="line"><span class="number">200</span></div></pre></td></tr></table></figure>
<h5 id="响应头"><a href="#响应头" class="headerlink" title="响应头"></a>响应头</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">r.headers</div><div class="line">&#123;</div><div class="line">    <span class="string">'content-encoding'</span>: <span class="string">'gzip'</span>,</div><div class="line">    <span class="string">'transfer-encoding'</span>: <span class="string">'chunked'</span>,</div><div class="line">    <span class="string">'connection'</span>: <span class="string">'close'</span>,</div><div class="line">    <span class="string">'server'</span>: <span class="string">'nginx/1.0.4'</span>,</div><div class="line">    <span class="string">'x-runtime'</span>: <span class="string">'148ms'</span>,</div><div class="line">    <span class="string">'etag'</span>: <span class="string">'"e1ca502697e5c9317743dc078f67693f"'</span>,</div><div class="line">    <span class="string">'content-type'</span>: <span class="string">'application/json'</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h5 id="获取Cookie"><a href="#获取Cookie" class="headerlink" title="获取Cookie"></a>获取Cookie</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">url = <span class="string">'https://github.com/timeline.json'</span></div><div class="line">r = requests.get(url)</div><div class="line">r.cookies[<span class="string">'example_cookie_name'</span>]</div><div class="line"><span class="string">'example_cookie_value'</span></div></pre></td></tr></table></figure>
<h5 id="发送Cookie"><a href="#发送Cookie" class="headerlink" title="发送Cookie"></a>发送Cookie</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">url = <span class="string">'https://github.com/timeline.json'</span></div><div class="line">cookies = dict(cookies_are=<span class="string">'working'</span>)</div><div class="line">r = requests.get(url, cookies=cookies)</div><div class="line">r.text</div></pre></td></tr></table></figure>
<h5 id="超时"><a href="#超时" class="headerlink" title="超时"></a>超时</h5><p>我们可以告诉requests在经过以timeout参数设定的秒数时间之后停止等待响应。<br>timeout 仅对连接过程有效，与响应体的下载无关。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">requests.get(<span class="string">'http://github.com'</span>, timeout=<span class="number">0.001</span>)</div></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Requests 作为Python的一款实用型http库，一直深受好评。让人用完就不太想使用其他的http库。&lt;br&gt;对于http不太了解的开发，采用其他库，会经常出现安全隐患，性能差，不经意造轮子，代码冗余等病状，&lt;br&gt;所以，在笔者看来Requests还是比较友好和谐的一款http库。&lt;br&gt;接下来，我们来看一下Requests和非Requests的对比。&lt;/p&gt;
&lt;h5 id=&quot;非Requests：&quot;&gt;&lt;a href=&quot;#非Requests：&quot; class=&quot;headerlink&quot; title=&quot;非Requests：&quot;&gt;&lt;/a&gt;非Requests：&lt;/h5&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;15&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;16&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;17&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;18&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;19&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;20&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;21&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;22&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;23&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;24&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;25&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#!/usr/bin/env python&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# -*- coding: utf-8 -*-&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; urllib2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;gh_url = &lt;span class=&quot;string&quot;&gt;&#39;https://api.github.com&#39;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;req = urllib2.Request(gh_url)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;password_manager = urllib2.HTTPPasswordMgrWithDefaultRealm()&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;password_manager.add_password(&lt;span class=&quot;keyword&quot;&gt;None&lt;/span&gt;, gh_url, &lt;span class=&quot;string&quot;&gt;&#39;user&#39;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;pass&#39;&lt;/span&gt;)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;auth_manager = urllib2.HTTPBasicAuthHandler(password_manager)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;opener = urllib2.build_opener(auth_manager)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;urllib2.install_opener(opener)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;handler = urllib2.urlopen(req)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;print&lt;/span&gt; handler.getcode()&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;print&lt;/span&gt; handler.headers.getheader(&lt;span class=&quot;string&quot;&gt;&#39;content-type&#39;&lt;/span&gt;)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# ------&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 200&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# &#39;application/json&#39;&lt;/span&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h5 id=&quot;Requests：&quot;&gt;&lt;a href=&quot;#Requests：&quot; class=&quot;headerlink&quot; title=&quot;Requests：&quot;&gt;&lt;/a&gt;Requests：&lt;/h5&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;r = requests.get(&lt;span class=&quot;string&quot;&gt;&#39;https://api.github.com/users&#39;&lt;/span&gt;, auth=(&lt;span class=&quot;string&quot;&gt;&#39;user&#39;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;pass&#39;&lt;/span&gt;))&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;print&lt;/span&gt; r.status_code&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# ------&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 200&lt;/span&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;对比后是不是感觉Requests非常的简洁明了。&lt;br&gt;
    
    </summary>
    
      <category term="python" scheme="http://bin.bloggao.cn/categories/python/"/>
    
    
      <category term="python" scheme="http://bin.bloggao.cn//tags/python/"/>
    
      <category term="http" scheme="http://bin.bloggao.cn//tags/http/"/>
    
  </entry>
  
  <entry>
    <title>locale修改linux语言环境</title>
    <link href="http://bin.bloggao.cn/2017/10/09/linux_locale/"/>
    <id>http://bin.bloggao.cn/2017/10/09/linux_locale/</id>
    <published>2017-10-09T08:39:15.000Z</published>
    <updated>2017-10-09T08:55:30.908Z</updated>
    
    <content type="html"><![CDATA[<p>最近用python脚本做文件写入，进vim看是乱码，以为是自己编码没处理好，处理后，发现打开还是不对。<br>然后用tail，cat发现又没毛病，而且vim打开所有文件写中文都是如此。<br>用locale查看了一下当前的语言环境。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">locale: Cannot set LC_CTYPE to default locale: No such file or directory</div><div class="line">locale: Cannot set LC_MESSAGES to default locale: No such file or directory</div><div class="line">locale: Cannot set LC_ALL to default locale: No such file or directory</div><div class="line">LANG=zh_CN.UTF-8</div><div class="line">LANGUAGE=zh_CN:zh</div><div class="line">LC_CTYPE=&quot;zh_CN.UTF-8&quot;</div><div class="line">LC_NUMERIC=zh_CN</div><div class="line">LC_TIME=zh_CN</div><div class="line">LC_COLLATE=&quot;zh_CN.UTF-8&quot;</div><div class="line">LC_MONETARY=zh_CN</div><div class="line">LC_MESSAGES=&quot;zh_CN.UTF-8&quot;</div><div class="line">LC_PAPER=zh_CN</div><div class="line">LC_NAME=zh_CN</div><div class="line">LC_ADDRESS=zh_CN</div><div class="line">LC_TELEPHONE=zh_CN</div><div class="line">LC_MEASUREMENT=zh_CN</div><div class="line">LC_IDENTIFICATION=zh_CN</div><div class="line">LC_ALL=</div></pre></td></tr></table></figure></p>
<h3 id="出现如下错误"><a href="#出现如下错误" class="headerlink" title="出现如下错误"></a>出现如下错误</h3><ul>
<li>locale: Cannot set LC_CTYPE to default locale: No such file or directory</li>
<li>locale: Cannot set LC_MESSAGES to default locale: No such file or directory</li>
<li>locale: Cannot set LC_ALL to default locale: No such file or directory<a id="more"></a>
</li>
</ul>
<p>再查看一下，系统安装的locale<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">locale -a</div><div class="line">locale: Cannot set LC_CTYPE to default locale: No such file or directory</div><div class="line">locale: Cannot set LC_MESSAGES to default locale: No such file or directory</div><div class="line">locale: Cannot set LC_COLLATE to default locale: No such file or directory</div><div class="line">C</div><div class="line">C.UTF-8</div><div class="line">POSIX</div><div class="line">en_US.utf8</div><div class="line">zh_CN</div><div class="line">zh_CN.gb2312</div></pre></td></tr></table></figure></p>
<p>果然，没有对应的zh_CN.UTF-8</p>
<p>安装zh_CN.UTF-8<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo locale-gen zh_CN.UTF-8</div></pre></td></tr></table></figure></p>
<p>locale再次查看<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">LANG=zh_CN.UTF-8</div><div class="line">LANGUAGE=zh_CN:zh</div><div class="line">LC_CTYPE=&quot;zh_CN.UTF-8&quot;</div><div class="line">LC_NUMERIC=zh_CN</div><div class="line">LC_TIME=zh_CN</div><div class="line">LC_COLLATE=&quot;zh_CN.UTF-8&quot;</div><div class="line">LC_MONETARY=zh_CN</div><div class="line">LC_MESSAGES=&quot;zh_CN.UTF-8&quot;</div><div class="line">LC_PAPER=zh_CN</div><div class="line">LC_NAME=zh_CN</div><div class="line">LC_ADDRESS=zh_CN</div><div class="line">LC_TELEPHONE=zh_CN</div><div class="line">LC_MEASUREMENT=zh_CN</div><div class="line">LC_IDENTIFICATION=zh_CN</div><div class="line">LC_ALL=</div></pre></td></tr></table></figure></p>
<p>最后vim进脚本一看，不再继续乱码。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;最近用python脚本做文件写入，进vim看是乱码，以为是自己编码没处理好，处理后，发现打开还是不对。&lt;br&gt;然后用tail，cat发现又没毛病，而且vim打开所有文件写中文都是如此。&lt;br&gt;用locale查看了一下当前的语言环境。&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;15&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;16&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;17&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;18&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;locale: Cannot set LC_CTYPE to default locale: No such file or directory&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;locale: Cannot set LC_MESSAGES to default locale: No such file or directory&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;locale: Cannot set LC_ALL to default locale: No such file or directory&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;LANG=zh_CN.UTF-8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;LANGUAGE=zh_CN:zh&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;LC_CTYPE=&amp;quot;zh_CN.UTF-8&amp;quot;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;LC_NUMERIC=zh_CN&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;LC_TIME=zh_CN&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;LC_COLLATE=&amp;quot;zh_CN.UTF-8&amp;quot;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;LC_MONETARY=zh_CN&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;LC_MESSAGES=&amp;quot;zh_CN.UTF-8&amp;quot;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;LC_PAPER=zh_CN&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;LC_NAME=zh_CN&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;LC_ADDRESS=zh_CN&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;LC_TELEPHONE=zh_CN&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;LC_MEASUREMENT=zh_CN&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;LC_IDENTIFICATION=zh_CN&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;LC_ALL=&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h3 id=&quot;出现如下错误&quot;&gt;&lt;a href=&quot;#出现如下错误&quot; class=&quot;headerlink&quot; title=&quot;出现如下错误&quot;&gt;&lt;/a&gt;出现如下错误&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;locale: Cannot set LC_CTYPE to default locale: No such file or directory&lt;/li&gt;
&lt;li&gt;locale: Cannot set LC_MESSAGES to default locale: No such file or directory&lt;/li&gt;
&lt;li&gt;locale: Cannot set LC_ALL to default locale: No such file or directory
    
    </summary>
    
      <category term="linux" scheme="http://bin.bloggao.cn/categories/linux/"/>
    
    
      <category term="linux" scheme="http://bin.bloggao.cn//tags/linux/"/>
    
  </entry>
  
  <entry>
    <title>linux修改ip设置</title>
    <link href="http://bin.bloggao.cn/2017/09/27/linux_ipset/"/>
    <id>http://bin.bloggao.cn/2017/09/27/linux_ipset/</id>
    <published>2017-09-27T08:54:52.000Z</published>
    <updated>2017-09-27T09:26:01.785Z</updated>
    
    <content type="html"><![CDATA[<p>有时候需要修改linux的ip,怕记不住，做个笔记，解决办法如下：</p>
<h2 id="step1-进入修改文件"><a href="#step1-进入修改文件" class="headerlink" title="step1(进入修改文件):"></a>step1(进入修改文件):</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">sudo vim /etc/config/networking/interfaces</div><div class="line">or</div><div class="line">sudo vim /etc/network/interfaces</div></pre></td></tr></table></figure>
<h2 id="step2-修改文件"><a href="#step2-修改文件" class="headerlink" title="step2(修改文件):"></a>step2(修改文件):</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">auto lo</div><div class="line"><span class="comment">#本地回环接口</span></div><div class="line">iface lo inet loopback</div><div class="line">auto eth0</div><div class="line"><span class="comment">#以太网接口</span></div><div class="line"><span class="comment">#iface eth0 inet dhcp </span></div><div class="line">iface eth0 inet static</div><div class="line"><span class="comment">#连接方式dhcp和固定ip</span></div><div class="line">address <span class="number">192.168</span><span class="number">.2</span><span class="number">.135</span></div><div class="line"><span class="comment">#ip地址</span></div><div class="line">gateway <span class="number">192.168</span><span class="number">.2</span><span class="number">.1</span></div><div class="line"><span class="comment">#ip网关</span></div><div class="line">netmask <span class="number">255.255</span><span class="number">.255</span><span class="number">.0</span></div><div class="line"><span class="comment">#子掩码</span></div></pre></td></tr></table></figure>
<a id="more"></a>
<h2 id="step3-重启"><a href="#step3-重启" class="headerlink" title="step3(重启):"></a>step3(重启):</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo /etc/init.d/networking  restart</div></pre></td></tr></table></figure>
<h2 id="step4-ping"><a href="#step4-ping" class="headerlink" title="step4(ping):"></a>step4(ping):</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">ping www.baidu.com</div><div class="line"></div><div class="line">if not:</div><div class="line">cat /etc/resolv.conf</div><div class="line">修改网关至192.168.2.1</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;有时候需要修改linux的ip,怕记不住，做个笔记，解决办法如下：&lt;/p&gt;
&lt;h2 id=&quot;step1-进入修改文件&quot;&gt;&lt;a href=&quot;#step1-进入修改文件&quot; class=&quot;headerlink&quot; title=&quot;step1(进入修改文件):&quot;&gt;&lt;/a&gt;step1(进入修改文件):&lt;/h2&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;sudo vim /etc/config/networking/interfaces&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;or&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;sudo vim /etc/network/interfaces&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;step2-修改文件&quot;&gt;&lt;a href=&quot;#step2-修改文件&quot; class=&quot;headerlink&quot; title=&quot;step2(修改文件):&quot;&gt;&lt;/a&gt;step2(修改文件):&lt;/h2&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;auto lo&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#本地回环接口&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;iface lo inet loopback&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;auto eth0&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#以太网接口&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#iface eth0 inet dhcp &lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;iface eth0 inet static&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#连接方式dhcp和固定ip&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;address &lt;span class=&quot;number&quot;&gt;192.168&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;.2&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;.135&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#ip地址&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;gateway &lt;span class=&quot;number&quot;&gt;192.168&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;.2&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;.1&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#ip网关&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;netmask &lt;span class=&quot;number&quot;&gt;255.255&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;.255&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;.0&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#子掩码&lt;/span&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="linux" scheme="http://bin.bloggao.cn/categories/linux/"/>
    
    
      <category term="linux" scheme="http://bin.bloggao.cn//tags/linux/"/>
    
  </entry>
  
  <entry>
    <title>在vmware上安装ubuntu16.04无法进入桌面或者桌面空白解决办法</title>
    <link href="http://bin.bloggao.cn/2017/09/21/linux_ubutu_gdm/"/>
    <id>http://bin.bloggao.cn/2017/09/21/linux_ubutu_gdm/</id>
    <published>2017-09-21T03:27:00.000Z</published>
    <updated>2017-09-21T03:44:47.758Z</updated>
    
    <content type="html"><![CDATA[<p>在虚拟机上安装ubuntu出现了这样的情况，开机后不能进入图形桌面，只能按crl+alt+f1~f6，在文本界面下登陆。<br><strong> 解决办法 </strong>：<br>step1:<br>按<code>crl+alt+f1</code>写换到文本模式下，键入用户名和密码登陆，然后切换到超级用户状态下:</p>
<p>step2：<br>输入<code>startx</code>命令切换到图形界面，会发图形界面什么都没有。</p>
<p>step3：<br>按<code>crl+alt+t</code>进入超级终端，安装<code>gdm</code></p>
<p>step4:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">sudo apt-get install gdm </div><div class="line"># 登录显示器</div><div class="line"></div><div class="line">sudo apt-get install ubuntu-desktop</div><div class="line"># ubuntu桌面</div><div class="line"></div><div class="line">sudo apt-get install gnome-core </div><div class="line"># 图形桌面环境</div></pre></td></tr></table></figure></p>
<p>step5:<br>重启ubuntu。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;在虚拟机上安装ubuntu出现了这样的情况，开机后不能进入图形桌面，只能按crl+alt+f1~f6，在文本界面下登陆。&lt;br&gt;&lt;strong&gt; 解决办法 &lt;/strong&gt;：&lt;br&gt;step1:&lt;br&gt;按&lt;code&gt;crl+alt+f1&lt;/code&gt;写换到文本模式下，键入
    
    </summary>
    
      <category term="linux" scheme="http://bin.bloggao.cn/categories/linux/"/>
    
    
      <category term="linux" scheme="http://bin.bloggao.cn//tags/linux/"/>
    
      <category term="Ubuntu" scheme="http://bin.bloggao.cn//tags/Ubuntu/"/>
    
  </entry>
  
  <entry>
    <title>图的基本算法bfs浅析</title>
    <link href="http://bin.bloggao.cn/2017/07/28/python_bfs/"/>
    <id>http://bin.bloggao.cn/2017/07/28/python_bfs/</id>
    <published>2017-07-28T09:10:45.000Z</published>
    <updated>2017-07-28T09:28:16.223Z</updated>
    
    <content type="html"><![CDATA[<p>关于图的搜索有两种：广度优先（bfs）深度优先 （dfs）。</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th>A</th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td>B</td>
<td></td>
<td></td>
<td></td>
<td>C</td>
<td></td>
</tr>
<tr>
<td>D</td>
<td>E</td>
<td>F</td>
<td></td>
<td>G</td>
<td></td>
<td>H</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td>I</td>
<td></td>
</tr>
</tbody>
</table>
<p>dfs:顺序应该为：ABDEF CGH I</p>
<p>bfs:顺序应该为：ABC DEF GH I</p>
<p>笔者总结：深度优先的过程也就是递归的过程, 而bfs是层级的过程，所以广度优先不可避免的需要用到队列。</p>
<a id="more"></a>
<p>以下是结合需求用Python写的bfs代码(为了解决一个涉行的最短选择)，因涉及需求，笔者有注释，仅供参考。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_rows</span><span class="params">(s_row, product_list, slot_p_count)</span>:</span></div><div class="line">    <span class="comment"># product_list eg:['p2', 'p3', 'p1', 'p1']</span></div><div class="line">    <span class="comment"># slot_p_count eg: &#123;'02': 1, '03': 2, '08': 3&#125;</span></div><div class="line">    end_rows_path = []</div><div class="line">    <span class="keyword">for</span> num <span class="keyword">in</span> range(<span class="number">0</span>, len(s_row)): </div><div class="line">    	status = <span class="number">0</span></div><div class="line">        row_order = []</div><div class="line">        temporary_order = []</div><div class="line">        copy_p_list = copy.deepcopy(product_list)</div><div class="line">        <span class="keyword">for</span> row <span class="keyword">in</span> s_row:</div><div class="line">            <span class="keyword">if</span> num &gt; status:</div><div class="line">            	status += <span class="number">1</span></div><div class="line">                <span class="keyword">continue</span></div><div class="line">        	<span class="comment"># get list tree intersection (must for del)</span></div><div class="line">            pro_in_slot = <span class="keyword">False</span></div><div class="line">            <span class="keyword">for</span> pro <span class="keyword">in</span> s_row[row]:</div><div class="line">                <span class="keyword">try</span>:</div><div class="line">                    pro_ad = copy_p_list.index(pro)</div><div class="line">                    <span class="keyword">del</span> copy_p_list[pro_ad]</div><div class="line">                    pro_in_slot = <span class="keyword">True</span></div><div class="line">                <span class="keyword">except</span> Exception, e:</div><div class="line">                    <span class="keyword">pass</span></div><div class="line">            <span class="keyword">if</span> pro_in_slot:</div><div class="line">            	row_order.append([row, slot_p_count[row]])</div><div class="line">            <span class="keyword">if</span> <span class="keyword">not</span> copy_p_list:</div><div class="line">            	temporary_order = copy.deepcopy(row_order)</div><div class="line">                <span class="keyword">break</span></div><div class="line">        <span class="keyword">if</span> temporary_order:</div><div class="line">            end_rows_path.append(temporary_order)</div><div class="line">    <span class="comment"># all end_rows_path eg: [['01', 5], ['05', 1], ...]  [row, all pro quantity]  Reason: less quantity priority</span></div><div class="line">    <span class="keyword">return</span> end_rows_path</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;关于图的搜索有两种：广度优先（bfs）深度优先 （dfs）。&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;/th&gt;
&lt;th&gt;&lt;/th&gt;
&lt;th&gt;&lt;/th&gt;
&lt;th&gt;A&lt;/th&gt;
&lt;th&gt;&lt;/th&gt;
&lt;th&gt;&lt;/th&gt;
&lt;th&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;B&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;C&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;D&lt;/td&gt;
&lt;td&gt;E&lt;/td&gt;
&lt;td&gt;F&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;G&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;H&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;I&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;dfs:顺序应该为：ABDEF CGH I&lt;/p&gt;
&lt;p&gt;bfs:顺序应该为：ABC DEF GH I&lt;/p&gt;
&lt;p&gt;笔者总结：深度优先的过程也就是递归的过程, 而bfs是层级的过程，所以广度优先不可避免的需要用到队列。&lt;/p&gt;
    
    </summary>
    
      <category term="python" scheme="http://bin.bloggao.cn/categories/python/"/>
    
    
      <category term="python" scheme="http://bin.bloggao.cn//tags/python/"/>
    
      <category term="bfs" scheme="http://bin.bloggao.cn//tags/bfs/"/>
    
  </entry>
  
  <entry>
    <title>python性能测量工具cProfile</title>
    <link href="http://bin.bloggao.cn/2017/07/27/python_cprofile/"/>
    <id>http://bin.bloggao.cn/2017/07/27/python_cprofile/</id>
    <published>2017-07-27T07:17:40.000Z</published>
    <updated>2017-07-27T07:38:42.987Z</updated>
    
    <content type="html"><![CDATA[<h2 id="背景："><a href="#背景：" class="headerlink" title="背景："></a>背景：</h2><p>Python是一种解释性的语言，执行速度相比C、C++等语言十分缓慢；因此我们需要在其它地方上下功夫来提高代码的执行速度。<br>首先需要对代码进行分析，这个时候则需要用一些工具。<br>这里介绍cProfile：<br>全代码分析：<br>命令行: cProfile -s tottime your_program.py<br>结果如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">ncalls  tottime  percall  cumtime  percall filename:lineno(function)</div><div class="line">   <span class="number">66</span>    <span class="number">0.001</span>    <span class="number">0.000</span>   <span class="number">11.850</span>    <span class="number">0.180</span>  base.py:<span class="number">228</span>(micro_service)</div><div class="line">   <span class="number">66</span>    <span class="number">0.003</span>    <span class="number">0.000</span>   <span class="number">11.849</span>    <span class="number">0.180</span>  tools.py:<span class="number">557</span>(micro_service)</div><div class="line"> <span class="number">1056</span>    <span class="number">0.001</span>    <span class="number">0.000</span>   <span class="number">11.073</span>    <span class="number">0.010</span>  connection.py:<span class="number">463</span>(drain_events)</div><div class="line"> <span class="number">1056</span>    <span class="number">0.015</span>    <span class="number">0.000</span>   <span class="number">11.072</span>    <span class="number">0.010</span>  connection.py:<span class="number">466</span>(blocking_read)</div><div class="line"> <span class="number">1056</span>    <span class="number">0.008</span>    <span class="number">0.000</span>   <span class="number">10.920</span>    <span class="number">0.010</span>  transport.py:<span class="number">233</span>(read_frame)</div><div class="line"> <span class="number">3168</span>    <span class="number">0.014</span>    <span class="number">0.000</span>   <span class="number">10.908</span>    <span class="number">0.003</span>  transport.py:<span class="number">370</span>(_read)</div><div class="line"> <span class="number">3168</span>   <span class="number">10.892</span>    <span class="number">0.003</span>   <span class="number">10.892</span>    <span class="number">0.003</span>  &#123;method <span class="string">'recv'</span> of <span class="string">'_socket.socket'</span> objects&#125;</div><div class="line">   <span class="number">66</span>    <span class="number">0.001</span>    <span class="number">0.000</span>    <span class="number">9.814</span>    <span class="number">0.149</span>  rpc.py:<span class="number">350</span>(__call__)</div><div class="line">   <span class="number">66</span>    <span class="number">0.001</span>    <span class="number">0.000</span>    <span class="number">8.395</span>    <span class="number">0.127</span>  rpc.py:<span class="number">329</span>(result)</div></pre></td></tr></table></figure>
<a id="more"></a>
<h2 id="块分析"><a href="#块分析" class="headerlink" title="块分析:"></a>块分析:</h2><p>上面属于文件分析,但是我们可能只对部分代码感兴趣，那么只需要在这部分代码的前后加上下面这两段代码即可：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> cProfile</div><div class="line">cp = cProfile.Profile()</div><div class="line">cp.enable()</div><div class="line"></div><div class="line">YOUR CODE</div><div class="line"></div><div class="line">cp.disable()</div><div class="line">cp.print_stats()</div></pre></td></tr></table></figure></p>
<p>结果与全代码分析的类似，但是只包含你感兴趣的部分。</p>
<h2 id="行分析"><a href="#行分析" class="headerlink" title="行分析:"></a>行分析:</h2><p>行分析需要安装line_profiler：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pip install line_profiler</div></pre></td></tr></table></figure></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">@profile</div><div class="line">def class_name()</div><div class="line">	pass</div></pre></td></tr></table></figure>
<p>然后在命令行输入：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">kernprof -l -v your_code.py</div><div class="line">-l 逐行分析</div><div class="line">-v 立即查看结果</div></pre></td></tr></table></figure></p>
<h2 id="示例："><a href="#示例：" class="headerlink" title="示例："></a>示例：</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> cProfile <span class="keyword">import</span> Profile <span class="keyword">as</span> profile </div><div class="line"><span class="keyword">from</span> pstats <span class="keyword">import</span> Stats </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">profile_module</span><span class="params">()</span>:</span> </div><div class="line">	p = profile() </div><div class="line">	p.snapshot_stats() </div><div class="line">	p.enable() </div><div class="line">	<span class="comment"># 需要调优的代码</span></div><div class="line">	p.disable() </div><div class="line">	p.print_stats(<span class="number">2</span>) <span class="comment"># 按照调用累加总耗时累加排序，即将最耗时的函数最优先</span></div><div class="line">	p.dump_stats(<span class="string">"call.log"</span>)</div></pre></td></tr></table></figure>
<p>关于profile和cProfile的更多链接，请点击：<br><a href="https://docs.python.org/3/library/profile.html?spm=5176.100239.0.0.qa5fU5" target="_blank" rel="external">https://docs.python.org/3/library/profile.html?spm=5176.100239.0.0.qa5fU5</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;背景：&quot;&gt;&lt;a href=&quot;#背景：&quot; class=&quot;headerlink&quot; title=&quot;背景：&quot;&gt;&lt;/a&gt;背景：&lt;/h2&gt;&lt;p&gt;Python是一种解释性的语言，执行速度相比C、C++等语言十分缓慢；因此我们需要在其它地方上下功夫来提高代码的执行速度。&lt;br&gt;首先需要对代码进行分析，这个时候则需要用一些工具。&lt;br&gt;这里介绍cProfile：&lt;br&gt;全代码分析：&lt;br&gt;命令行: cProfile -s tottime your_program.py&lt;br&gt;结果如下：&lt;/p&gt;
&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;ncalls  tottime  percall  cumtime  percall filename:lineno(function)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;   &lt;span class=&quot;number&quot;&gt;66&lt;/span&gt;    &lt;span class=&quot;number&quot;&gt;0.001&lt;/span&gt;    &lt;span class=&quot;number&quot;&gt;0.000&lt;/span&gt;   &lt;span class=&quot;number&quot;&gt;11.850&lt;/span&gt;    &lt;span class=&quot;number&quot;&gt;0.180&lt;/span&gt;  base.py:&lt;span class=&quot;number&quot;&gt;228&lt;/span&gt;(micro_service)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;   &lt;span class=&quot;number&quot;&gt;66&lt;/span&gt;    &lt;span class=&quot;number&quot;&gt;0.003&lt;/span&gt;    &lt;span class=&quot;number&quot;&gt;0.000&lt;/span&gt;   &lt;span class=&quot;number&quot;&gt;11.849&lt;/span&gt;    &lt;span class=&quot;number&quot;&gt;0.180&lt;/span&gt;  tools.py:&lt;span class=&quot;number&quot;&gt;557&lt;/span&gt;(micro_service)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt; &lt;span class=&quot;number&quot;&gt;1056&lt;/span&gt;    &lt;span class=&quot;number&quot;&gt;0.001&lt;/span&gt;    &lt;span class=&quot;number&quot;&gt;0.000&lt;/span&gt;   &lt;span class=&quot;number&quot;&gt;11.073&lt;/span&gt;    &lt;span class=&quot;number&quot;&gt;0.010&lt;/span&gt;  connection.py:&lt;span class=&quot;number&quot;&gt;463&lt;/span&gt;(drain_events)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt; &lt;span class=&quot;number&quot;&gt;1056&lt;/span&gt;    &lt;span class=&quot;number&quot;&gt;0.015&lt;/span&gt;    &lt;span class=&quot;number&quot;&gt;0.000&lt;/span&gt;   &lt;span class=&quot;number&quot;&gt;11.072&lt;/span&gt;    &lt;span class=&quot;number&quot;&gt;0.010&lt;/span&gt;  connection.py:&lt;span class=&quot;number&quot;&gt;466&lt;/span&gt;(blocking_read)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt; &lt;span class=&quot;number&quot;&gt;1056&lt;/span&gt;    &lt;span class=&quot;number&quot;&gt;0.008&lt;/span&gt;    &lt;span class=&quot;number&quot;&gt;0.000&lt;/span&gt;   &lt;span class=&quot;number&quot;&gt;10.920&lt;/span&gt;    &lt;span class=&quot;number&quot;&gt;0.010&lt;/span&gt;  transport.py:&lt;span class=&quot;number&quot;&gt;233&lt;/span&gt;(read_frame)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt; &lt;span class=&quot;number&quot;&gt;3168&lt;/span&gt;    &lt;span class=&quot;number&quot;&gt;0.014&lt;/span&gt;    &lt;span class=&quot;number&quot;&gt;0.000&lt;/span&gt;   &lt;span class=&quot;number&quot;&gt;10.908&lt;/span&gt;    &lt;span class=&quot;number&quot;&gt;0.003&lt;/span&gt;  transport.py:&lt;span class=&quot;number&quot;&gt;370&lt;/span&gt;(_read)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt; &lt;span class=&quot;number&quot;&gt;3168&lt;/span&gt;   &lt;span class=&quot;number&quot;&gt;10.892&lt;/span&gt;    &lt;span class=&quot;number&quot;&gt;0.003&lt;/span&gt;   &lt;span class=&quot;number&quot;&gt;10.892&lt;/span&gt;    &lt;span class=&quot;number&quot;&gt;0.003&lt;/span&gt;  &amp;#123;method &lt;span class=&quot;string&quot;&gt;&#39;recv&#39;&lt;/span&gt; of &lt;span class=&quot;string&quot;&gt;&#39;_socket.socket&#39;&lt;/span&gt; objects&amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;   &lt;span class=&quot;number&quot;&gt;66&lt;/span&gt;    &lt;span class=&quot;number&quot;&gt;0.001&lt;/span&gt;    &lt;span class=&quot;number&quot;&gt;0.000&lt;/span&gt;    &lt;span class=&quot;number&quot;&gt;9.814&lt;/span&gt;    &lt;span class=&quot;number&quot;&gt;0.149&lt;/span&gt;  rpc.py:&lt;span class=&quot;number&quot;&gt;350&lt;/span&gt;(__call__)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;   &lt;span class=&quot;number&quot;&gt;66&lt;/span&gt;    &lt;span class=&quot;number&quot;&gt;0.001&lt;/span&gt;    &lt;span class=&quot;number&quot;&gt;0.000&lt;/span&gt;    &lt;span class=&quot;number&quot;&gt;8.395&lt;/span&gt;    &lt;span class=&quot;number&quot;&gt;0.127&lt;/span&gt;  rpc.py:&lt;span class=&quot;number&quot;&gt;329&lt;/span&gt;(result)&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="python" scheme="http://bin.bloggao.cn/categories/python/"/>
    
    
      <category term="python" scheme="http://bin.bloggao.cn//tags/python/"/>
    
      <category term="cProfile" scheme="http://bin.bloggao.cn//tags/cProfile/"/>
    
  </entry>
  
  <entry>
    <title>多窗口工具tmux快捷键速查表</title>
    <link href="http://bin.bloggao.cn/2017/07/10/tmux_linux/"/>
    <id>http://bin.bloggao.cn/2017/07/10/tmux_linux/</id>
    <published>2017-07-10T05:12:40.000Z</published>
    <updated>2020-05-21T10:19:11.507Z</updated>
    
    <content type="html"><![CDATA[<h2 id="介绍："><a href="#介绍：" class="headerlink" title="介绍："></a>介绍：</h2><p>tmux 是在一个终端进行多窗口回话的工具，可在后台运行，进入、断开会话。<br>如下图示例：</p>
<img src="/images/tmux_001.png" width="700" height="280" title="liecol-晓斌|tmux liecol-晓斌|tmux">
<h2 id="tmux的快捷键前缀："><a href="#tmux的快捷键前缀：" class="headerlink" title="tmux的快捷键前缀："></a>tmux的快捷键前缀：</h2><ul>
<li>按下组合键 Ctrl+b (Tmux 快捷键前缀)</li>
<li>放开组合键 Ctrl+b</li>
<li>按下 tmux内部指令<a id="more"></a>
</li>
</ul>
<h2 id="安装tmux"><a href="#安装tmux" class="headerlink" title="安装tmux"></a>安装tmux</h2><p>笔者以Ubuntu为例：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo apt-get install tmux</div></pre></td></tr></table></figure></p>
<h2 id="修改tmux数据配置："><a href="#修改tmux数据配置：" class="headerlink" title="修改tmux数据配置："></a>修改tmux数据配置：</h2><p>–路径:~/.tmux.conf<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">前缀绑定 (Ctrl+a)</div><div class="line">set -g prefix ^a</div><div class="line">unbind ^b</div><div class="line">bind a send-prefix</div><div class="line"></div><div class="line">居中窗口列表</div><div class="line">set -g status-justify centre</div><div class="line"></div><div class="line">最大化/恢复窗格</div><div class="line">unbind Up bind Up new-window -d -n tmp \; swap-pane -s tmp.1 \; select-window -t tmp</div><div class="line">unbind Down</div><div class="line">bind Down last-window \; swap-pane -s tmp.1 \; kill-window -t tmp</div></pre></td></tr></table></figure></p>
<h2 id="tmux会话快捷键"><a href="#tmux会话快捷键" class="headerlink" title="tmux会话快捷键:"></a>tmux会话快捷键:</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">启动新会话</div><div class="line">tmux new -s session-name</div><div class="line">eg: tmux new -s liecol-0</div><div class="line"></div><div class="line">列出所有会话：</div><div class="line">tmux ls</div><div class="line">create By liecol-晓斌</div><div class="line"></div><div class="line">恢复会话：</div><div class="line">tmux at [-t 会话名]</div><div class="line">tmux a -t session-name</div><div class="line">eg: tmux at -t liecol</div><div class="line"></div><div class="line">强制独占恢复会话：</div><div class="line">tmux at [-dt 会话名]</div><div class="line">tmux at -dt liecol</div><div class="line"></div><div class="line">删除会话</div><div class="line">tmux kill-session -t session-name</div><div class="line">tmux kill-session -t liecol1</div></pre></td></tr></table></figure>
<h2 id="窗口-amp-窗格杂项："><a href="#窗口-amp-窗格杂项：" class="headerlink" title="窗口&amp;窗格杂项："></a>窗口&amp;窗格杂项：</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">s 列出所有会话 可用上下键进入对应会话</div><div class="line">$ 重命名当前的会话</div><div class="line">d 断开当前的会话</div><div class="line"></div><div class="line">窗口 (标签页)</div><div class="line">c  创建新窗口</div><div class="line">w  列出所有窗口</div><div class="line">n  后一个窗口</div><div class="line">p  前一个窗口</div><div class="line">f  查找窗口</div><div class="line">,  重命名当前窗口</div><div class="line">&amp;  关闭当前窗口</div><div class="line"></div><div class="line">窗格</div><div class="line">% 水平分割窗口</div><div class="line">&quot; 竖直分割窗口</div><div class="line">&#125; 与下一个窗格交换位置</div><div class="line">&#123; 与上一个窗格交换位置</div><div class="line">将光标移入对应窗口 上下左右箭头</div><div class="line">t 钟表时间</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;介绍：&quot;&gt;&lt;a href=&quot;#介绍：&quot; class=&quot;headerlink&quot; title=&quot;介绍：&quot;&gt;&lt;/a&gt;介绍：&lt;/h2&gt;&lt;p&gt;tmux 是在一个终端进行多窗口回话的工具，可在后台运行，进入、断开会话。&lt;br&gt;如下图示例：&lt;/p&gt;
&lt;img src=&quot;/images/tmux_001.png&quot; width=&quot;700&quot; height=&quot;280&quot; title=&quot;liecol-晓斌|tmux liecol-晓斌|tmux&quot;&gt;
&lt;h2 id=&quot;tmux的快捷键前缀：&quot;&gt;&lt;a href=&quot;#tmux的快捷键前缀：&quot; class=&quot;headerlink&quot; title=&quot;tmux的快捷键前缀：&quot;&gt;&lt;/a&gt;tmux的快捷键前缀：&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;按下组合键 Ctrl+b (Tmux 快捷键前缀)&lt;/li&gt;
&lt;li&gt;放开组合键 Ctrl+b&lt;/li&gt;
&lt;li&gt;按下 tmux内部指令
    
    </summary>
    
      <category term="linux" scheme="http://bin.bloggao.cn/categories/linux/"/>
    
    
      <category term="linux" scheme="http://bin.bloggao.cn//tags/linux/"/>
    
      <category term="tmux" scheme="http://bin.bloggao.cn//tags/tmux/"/>
    
  </entry>
  
  <entry>
    <title>Date.parse在IE里NaN问题的解决方式</title>
    <link href="http://bin.bloggao.cn/2017/04/23/date_parse/"/>
    <id>http://bin.bloggao.cn/2017/04/23/date_parse/</id>
    <published>2017-04-23T05:59:50.000Z</published>
    <updated>2017-05-15T06:03:01.112Z</updated>
    
    <content type="html"><![CDATA[<p>之前处理时间问题发现ie浏览器里，Date.parse不起效果，兼容解决方式如下：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> start_time = test_time.replace(<span class="regexp">/-/g</span>,<span class="string">'/'</span>);</div><div class="line">start_time = <span class="keyword">new</span> <span class="built_in">Date</span>(start_time);</div><div class="line"><span class="keyword">var</span> result = start_time.getTime();</div></pre></td></tr></table></figure></p>
<p>create By liecol-晓斌</p>
<p>2017.04.23</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;之前处理时间问题发现ie浏览器里，Date.parse不起效果，兼容解决方式如下：&lt;br&gt;&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;
    
    </summary>
    
      <category term="javascript" scheme="http://bin.bloggao.cn/categories/javascript/"/>
    
    
      <category term="javascript" scheme="http://bin.bloggao.cn//tags/javascript/"/>
    
  </entry>
  
  <entry>
    <title>chrome通过SwitchyOmega配置代理</title>
    <link href="http://bin.bloggao.cn/2017/01/11/chrome_SwitchyOmega/"/>
    <id>http://bin.bloggao.cn/2017/01/11/chrome_SwitchyOmega/</id>
    <published>2017-01-11T09:56:30.000Z</published>
    <updated>2017-12-14T10:48:26.892Z</updated>
    
    <content type="html"><![CDATA[<p>之前公司搭建的vpn丢包80%以上，搞的我很郁闷，玩不了。<br>然后就找了一种新的PAC脚本方式，在这做个记录。</p>
<ul>
<li>安装 SwitchyOmega.</li>
</ul>
<p>这个是google的一个扩展程序。<br>SwitchyOmega可以在谷歌应用商店安装。</p>
<p>如果没法连接，也可以在<a href="https://github.com/FelisCatus/SwitchyOmega/releases" target="_blank" rel="external">github下载安装最新版</a>安装。<br>安装直接拖动到 google-&gt;更多工具-&gt;扩展程序即可，上面的链接也有显示如何安装。<br><a id="more"></a></p>
<img src="/images/chrom_extensions.png" width="700" height="280" title="liecol-晓斌|谷歌扩展图 liecol-晓斌|谷歌扩展图">
<ul>
<li>新建情景模式</li>
<li><p>选择PAC情景模式</p>
<img src="/images/add_extension_switch.png" width="700" height="280" title="liecol-晓斌|新建情景模式 liecol-晓斌|新建情景模式">
</li>
<li><p>PAC网址选为<br><a href="https://raw.githubusercontent.com/kgfw/fg/master/pac/cfu.pac" target="_blank" rel="external">https://raw.githubusercontent.com/kgfw/fg/master/pac/cfu.pac</a></p>
</li>
</ul>
<img src="/images/pac_address.png" width="700" height="280" title="liecol-晓斌|PAC地址 liecol-晓斌|PAC地址">
<ul>
<li>auto switch 设置<br>有些网站可以不用走代理，就可以在此设置。</li>
</ul>
<img src="/images/auto_switch.png" width="700" height="280" title="liecol-晓斌|auto switch liecol-晓斌|auto switch">
<p>然后google选择对应的模式即可访问了。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;之前公司搭建的vpn丢包80%以上，搞的我很郁闷，玩不了。&lt;br&gt;然后就找了一种新的PAC脚本方式，在这做个记录。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;安装 SwitchyOmega.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;这个是google的一个扩展程序。&lt;br&gt;SwitchyOmega可以在谷歌应用商店安装。&lt;/p&gt;
&lt;p&gt;如果没法连接，也可以在&lt;a href=&quot;https://github.com/FelisCatus/SwitchyOmega/releases&quot;&gt;github下载安装最新版&lt;/a&gt;安装。&lt;br&gt;安装直接拖动到 google-&amp;gt;更多工具-&amp;gt;扩展程序即可，上面的链接也有显示如何安装。&lt;br&gt;
    
    </summary>
    
      <category term="linux" scheme="http://bin.bloggao.cn/categories/linux/"/>
    
    
      <category term="chrome" scheme="http://bin.bloggao.cn//tags/chrome/"/>
    
      <category term="google" scheme="http://bin.bloggao.cn//tags/google/"/>
    
  </entry>
  
  <entry>
    <title>hexo 添加百度谷歌收录sitemap</title>
    <link href="http://bin.bloggao.cn/2017/01/10/hexo_sitemap/"/>
    <id>http://bin.bloggao.cn/2017/01/10/hexo_sitemap/</id>
    <published>2017-01-10T08:51:52.000Z</published>
    <updated>2017-09-27T09:01:28.019Z</updated>
    
    <content type="html"><![CDATA[<p><strong>自动推送:</strong><br>最近发现百度没收录blog子页，然后就研究了一番。<br>之前在theme里添加了一段百度自动推送的js：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&lt;script&gt;</div><div class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> bp = <span class="built_in">document</span>.createElement(<span class="string">'script'</span>);</div><div class="line">    <span class="keyword">var</span> curProtocol = <span class="built_in">window</span>.location.protocol.split(<span class="string">':'</span>)[<span class="number">0</span>];</div><div class="line">    <span class="keyword">if</span> (curProtocol === <span class="string">'https'</span>) &#123;</div><div class="line">        bp.src = <span class="string">'https://zz.bdstatic.com/linksubmit/push.js'</span>;        </div><div class="line">    &#125;</div><div class="line">    <span class="keyword">else</span> &#123;</div><div class="line">        bp.src = <span class="string">'http://push.zhanzhang.baidu.com/push.js'</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">var</span> s = <span class="built_in">document</span>.getElementsByTagName(<span class="string">"script"</span>)[<span class="number">0</span>];</div><div class="line">    s.parentNode.insertBefore(bp, s);</div><div class="line">&#125;)();</div><div class="line">&lt;/script&gt;</div></pre></td></tr></table></figure>
<a id="more"></a>
<p><strong>sitemap提交:</strong><br>感觉没啥人点，自己也懒得点，算了，再补一个sitemap。<br>hexo 站点地图的插件安装方式如下：<br>google：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install hexo-generator-sitemap --save</div></pre></td></tr></table></figure></p>
<p>百度：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install hexo-generator-baidu-sitemap --save</div></pre></td></tr></table></figure></p>
<p>之后编译Blog<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">hexo g</div></pre></td></tr></table></figure></p>
<p><a href="http://bin.bloggao.cn/sitemap.xml">http://bin.bloggao.cn/sitemap.xml</a><br><a href="http://bin.bloggao.cn/baidusitemap.xml">http://bin.bloggao.cn/baidusitemap.xml</a></p>
<p><strong>主动推送(这个效率最高):</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install hexo-baidu-url-submit --save</div></pre></td></tr></table></figure></p>
<p>根目录_config.yml配置文件：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">baidu_url_submit:</div><div class="line">  count: 3 ## 提交最新的链接数量</div><div class="line">  host: bin.bloggao.cn ## 域名</div><div class="line">  token: your_token ## 百度主动推送的token，私钥</div><div class="line">  path: baidu_urls.txt ## 主动推送的文件地址</div></pre></td></tr></table></figure></p>
<p>追加deploy<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">deploy:</div><div class="line">- type: baidu_url_submitter</div></pre></td></tr></table></figure></p>
<p>比如博主的是同时到coding和github的：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">deploy:</div><div class="line">- type: git</div><div class="line">  repo: </div><div class="line">    github: https://github.com/liecol-gao/liecol-gao.github.io.git,master</div><div class="line">    coding: https://git.coding.net/liecol/liecol.git,coding-pages</div><div class="line">- type: baidu_url_submitter</div></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;自动推送:&lt;/strong&gt;&lt;br&gt;最近发现百度没收录blog子页，然后就研究了一番。&lt;br&gt;之前在theme里添加了一段百度自动推送的js：&lt;/p&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&amp;lt;script&amp;gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; bp = &lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.createElement(&lt;span class=&quot;string&quot;&gt;&#39;script&#39;&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; curProtocol = &lt;span class=&quot;built_in&quot;&gt;window&lt;/span&gt;.location.protocol.split(&lt;span class=&quot;string&quot;&gt;&#39;:&#39;&lt;/span&gt;)[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;];&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (curProtocol === &lt;span class=&quot;string&quot;&gt;&#39;https&#39;&lt;/span&gt;) &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        bp.src = &lt;span class=&quot;string&quot;&gt;&#39;https://zz.bdstatic.com/linksubmit/push.js&#39;&lt;/span&gt;;        &lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        bp.src = &lt;span class=&quot;string&quot;&gt;&#39;http://push.zhanzhang.baidu.com/push.js&#39;&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; s = &lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.getElementsByTagName(&lt;span class=&quot;string&quot;&gt;&quot;script&quot;&lt;/span&gt;)[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;];&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    s.parentNode.insertBefore(bp, s);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;#125;)();&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;lt;/script&amp;gt;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="hexo" scheme="http://bin.bloggao.cn/categories/hexo/"/>
    
    
      <category term="hexo" scheme="http://bin.bloggao.cn//tags/hexo/"/>
    
      <category term="Blog" scheme="http://bin.bloggao.cn//tags/Blog/"/>
    
  </entry>
  
  <entry>
    <title>hexo LF will be replaced by CRLF 错误</title>
    <link href="http://bin.bloggao.cn/2017/01/10/hexo_lf_will_be_replaced_by_crlf/"/>
    <id>http://bin.bloggao.cn/2017/01/10/hexo_lf_will_be_replaced_by_crlf/</id>
    <published>2017-01-10T08:32:52.000Z</published>
    <updated>2017-01-10T08:39:41.113Z</updated>
    
    <content type="html"><![CDATA[<p>今天用hexo deploy 到github和coding，发现如下错误。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">warning: LF will be replaced by CRLF in tags/wechat/index.html.</div><div class="line">The file will have its original line endings in your working directory.</div></pre></td></tr></table></figure></p>
<p>看到网上资源很少，这边做个记录。<br>解决方式为：</p>
<ul>
<li>删除.deploy_git 目录</li>
<li>git config –global core.autocrlf false</li>
<li>hexo clean</li>
<li>hexo g</li>
<li>hexo d</li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;今天用hexo deploy 到github和coding，发现如下错误。&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div
    
    </summary>
    
      <category term="hexo" scheme="http://bin.bloggao.cn/categories/hexo/"/>
    
    
      <category term="hexo" scheme="http://bin.bloggao.cn//tags/hexo/"/>
    
      <category term="Blog" scheme="http://bin.bloggao.cn//tags/Blog/"/>
    
  </entry>
  
  <entry>
    <title>关于开发wechat小程序</title>
    <link href="http://bin.bloggao.cn/2017/01/09/wechat_min_app/"/>
    <id>http://bin.bloggao.cn/2017/01/09/wechat_min_app/</id>
    <published>2017-01-09T15:54:50.000Z</published>
    <updated>2017-01-10T02:54:32.480Z</updated>
    
    <content type="html"><![CDATA[<p>小程序今日上线致敬乔布斯，朋友圈一堆言论刷屏以及一片卧槽声起伏不定。<br>博主也不能免俗的研究了一番，注册了一个小程序，写了个demo。<br>首先发表点个人对该产品的观点：</p>
<ul>
<li>用完即走，目前看来第一批试用者倒是实实在在的没有玩坏，不过根据文档来看，玩坏是早晚的事儿。</li>
<li>与其他应用共用UnionID，这种事儿就能看出腾讯心很大。</li>
<li>优势在于开发上速度会更快，用户量以及用户推广也会方便不少。<br><strong>说说技术坑点：</strong></li>
<li>https,博主不想说脏话。</li>
<li>rpx,博主再次不想说脏话。</li>
<li>自己杜撰程序脚本，博主还是不想说脏话。<a id="more"></a>
</li>
</ul>
<p><strong>说一下它的技术优势:</strong></p>
<ul>
<li>微信api调用方便。</li>
<li>h5处理方便。</li>
<li>少了公众号授权步骤，加载上有微提升。</li>
</ul>
<p>接下来说说对开发文档的理解，个人觉得其有仿js框架的嫌疑，属于野路子里杜撰的一个脚本规则：<br>其实小程序的文档写的还是蛮清楚的：</p>
<ul>
<li>app.json 配置</li>
<li>app.js 脚本</li>
<li>app.wxss 样式</li>
<li>test.wxml 类似html的标签脚本</li>
</ul>
<p><em>小程序页面由以上4部分组成，当然这4个需要放置在同一个目录以及配置同一个文件名称。</em></p>
<hr>
<ul>
<li>wx.api 微信原生API</li>
</ul>
<p>app.json<br>结构与json一致：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&#123;<span class="string">"a"</span>:a, <span class="string">"b"</span>:b, <span class="string">"c"</span>:c&#125;</div></pre></td></tr></table></figure></p>
<p>从他们官方的demo里我摘出了一部分初始配置：</p>
<ul>
<li>pages指显示需要用到的一些page路径;</li>
<li>window指对该窗口的一些配置;</li>
<li>tabBar指的是tab菜单;</li>
<li>networkTimeout指窗口超时配置。</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="string">"pages"</span>: [</div><div class="line">    <span class="string">"page/component/index"</span>,</div><div class="line">    <span class="string">"page/API/storage/storage"</span></div><div class="line">  ],</div><div class="line">  <span class="string">"window"</span>: &#123;</div><div class="line">    <span class="string">"navigationBarTextStyle"</span>: <span class="string">"black"</span>,</div><div class="line">    <span class="string">"navigationBarTitleText"</span>: <span class="string">"演示"</span>,</div><div class="line">    <span class="string">"navigationBarBackgroundColor"</span>: <span class="string">"#fbf9fe"</span>,</div><div class="line">    <span class="string">"backgroundColor"</span>: <span class="string">"#fbf9fe"</span></div><div class="line">  &#125;,</div><div class="line">  <span class="string">"tabBar"</span>: &#123;</div><div class="line">    <span class="string">"color"</span>: <span class="string">"#dddddd"</span>,</div><div class="line">    <span class="string">"selectedColor"</span>: <span class="string">"#3cc51f"</span>,</div><div class="line">    <span class="string">"borderStyle"</span>: <span class="string">"black"</span>,</div><div class="line">    <span class="string">"backgroundColor"</span>: <span class="string">"#ffffff"</span>,</div><div class="line">    <span class="string">"list"</span>: [&#123;</div><div class="line">      <span class="string">"pagePath"</span>: <span class="string">"page/component/index"</span>,</div><div class="line">      <span class="string">"iconPath"</span>: <span class="string">"image/icon_component.png"</span>,</div><div class="line">      <span class="string">"selectedIconPath"</span>: <span class="string">"image/icon_component_HL.png"</span>,</div><div class="line">      <span class="string">"text"</span>: <span class="string">"组件"</span></div><div class="line">    &#125;, &#123;</div><div class="line">      <span class="string">"pagePath"</span>: <span class="string">"page/API/index/index"</span>,</div><div class="line">      <span class="string">"iconPath"</span>: <span class="string">"image/icon_API.png"</span>,</div><div class="line">      <span class="string">"selectedIconPath"</span>: <span class="string">"image/icon_API_HL.png"</span>,</div><div class="line">      <span class="string">"text"</span>: <span class="string">"接口"</span></div><div class="line">    &#125;]</div><div class="line">  &#125;,</div><div class="line">  <span class="string">"networkTimeout"</span>: &#123;</div><div class="line">    <span class="string">"request"</span>: <span class="number">10000</span>,</div><div class="line">    <span class="string">"connectSocket"</span>: <span class="number">10000</span>,</div><div class="line">    <span class="string">"uploadFile"</span>: <span class="number">10000</span>,</div><div class="line">    <span class="string">"downloadFile"</span>: <span class="number">10000</span></div><div class="line">  &#125;,</div><div class="line">  <span class="string">"debug"</span>: <span class="literal">true</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>app.js<br>结构(obj参数)：<br>注册程序：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">App(&#123;</div><div class="line">  <span class="attr">onLaunch</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'App Launch'</span>)</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">myfunction</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    ...</div><div class="line">  &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<p>注册页面：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">Page(&#123;</div><div class="line">  <span class="attr">data</span>: &#123;</div><div class="line">    <span class="attr">texts</span>: [</div><div class="line">      <span class="string">'第1个'</span>,</div><div class="line">      <span class="string">'第2个'</span>,</div><div class="line">      <span class="string">'第3个'</span></div><div class="line">    ]</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">tabchange</span>: <span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'第 '</span> + e.detail.current + <span class="string">' 个t'</span>)</div><div class="line">  &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<p>结构基本如上显示，后面可根据自己的需要来增加对应代码，当然在脚本app.js也依然可以申明js变量。</p>
<p>app.wxss<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="number">1</span>rpx = <span class="number">0.5</span>px</div></pre></td></tr></table></figure></p>
<p>这里面除了rpx比较搞，其他的都还好。</p>
<p>test.wxml<br>这里test是我自己写的。<br>类似于html的标签脚本<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">view</span>/&gt;</span>、<span class="tag">&lt;<span class="name">image</span>/&gt;</span>、<span class="tag">&lt;<span class="name">text</span>/&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">placeholder</span>=<span class="string">"liecol_input_自动对焦"</span> <span class="attr">auto-focus</span>/&gt;</span></div></pre></td></tr></table></figure></p>
<p>这玩意儿刚开始不对应对应，还真有可能会乱掉。</p>
<p>标签数据绑定<br>这就是绝对的js框架搬过来了<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&#123;&#123; message &#125;&#125;</div><div class="line">Page(&#123;</div><div class="line">  <span class="attr">data</span>: &#123;</div><div class="line">    <span class="attr">message</span>: <span class="string">'Hello LIECOL!'</span></div><div class="line">  &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<p>这里的事件还是蛮有意思的，写起来也很轻松。<br>例如：</p>
<ul>
<li>longtap 手指触摸后，超过350ms再离开</li>
<li>touchcancel 手指触摸动作被打断，如来电提醒，弹窗<br>等等…<br>这个官方文档写的很清楚，我在这里就不再赘述。</li>
</ul>
<p>wx.api<br>微信原生api.<br>如果大家都开发过公众号的话，相信很清楚，根据对应的微信原生api调用方式调用即可。<br>在小程序这边都是以wx.作为前缀。<br>这些原生的微信api接口还是非常实用的，文档也很清楚，在这仅举一例即可：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">App(&#123;</div><div class="line">  <span class="attr">onLaunch</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    wx.login(&#123;</div><div class="line">      <span class="attr">success</span>: <span class="function"><span class="keyword">function</span>(<span class="params">res</span>) </span>&#123;</div><div class="line">        <span class="keyword">if</span> (res.code) &#123;</div><div class="line">          <span class="comment">//发起网络请求</span></div><div class="line">          wx.request(&#123;</div><div class="line">            <span class="attr">url</span>: <span class="string">'https://test.com/onLogin'</span>,</div><div class="line">            <span class="attr">data</span>: &#123;</div><div class="line">              <span class="attr">code</span>: res.code</div><div class="line">            &#125;</div><div class="line">          &#125;)</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">          <span class="built_in">console</span>.log(<span class="string">'获取用户登录态失败！'</span> + res.errMsg)</div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">    &#125;);</div><div class="line">  &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<ul>
<li>APP:界面程序里</li>
<li>onLaunch为：生命周期函数–监听小程序初始化</li>
<li>wx.login 为微信的原生api接口</li>
<li>wx.request 为发起的 HTTPS 请求。</li>
<li>url为地址</li>
<li>data为参数</li>
</ul>
<p>关于小程序基本的结构介绍差不多就是这些.<br>还有一些关于继承A-继承-&gt;B-继承-&gt;C 但是A-/继承-&gt;C<br>一类的就让大家在开发过程中自己去探索吧。<br>Create By<br>liecol-晓斌<br>2017-01-09</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;小程序今日上线致敬乔布斯，朋友圈一堆言论刷屏以及一片卧槽声起伏不定。&lt;br&gt;博主也不能免俗的研究了一番，注册了一个小程序，写了个demo。&lt;br&gt;首先发表点个人对该产品的观点：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;用完即走，目前看来第一批试用者倒是实实在在的没有玩坏，不过根据文档来看，玩坏是早晚的事儿。&lt;/li&gt;
&lt;li&gt;与其他应用共用UnionID，这种事儿就能看出腾讯心很大。&lt;/li&gt;
&lt;li&gt;优势在于开发上速度会更快，用户量以及用户推广也会方便不少。&lt;br&gt;&lt;strong&gt;说说技术坑点：&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;https,博主不想说脏话。&lt;/li&gt;
&lt;li&gt;rpx,博主再次不想说脏话。&lt;/li&gt;
&lt;li&gt;自己杜撰程序脚本，博主还是不想说脏话。
    
    </summary>
    
      <category term="wechat" scheme="http://bin.bloggao.cn/categories/wechat/"/>
    
    
      <category term="wechat" scheme="http://bin.bloggao.cn//tags/wechat/"/>
    
  </entry>
  
  <entry>
    <title>Apache2.4与2.2版本访问配置对比</title>
    <link href="http://bin.bloggao.cn/2016/12/25/Apache_Directory/"/>
    <id>http://bin.bloggao.cn/2016/12/25/Apache_Directory/</id>
    <published>2016-12-25T11:02:25.000Z</published>
    <updated>2017-01-03T07:27:23.705Z</updated>
    
    <content type="html"><![CDATA[<p>之前折腾服务器，从<code>Apache2.2</code>-&gt;<code>Nginx1.10</code>-&gt;<code>Apache2.4</code><br>在指定挂载目录的时候出现这么一个问题,log显示为：<br>403错误<br><strong>You don’t have permission to access / on this server.</strong><br><a id="more"></a><br>当时想着Directory更改为如下方式：<br><figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="section">&lt;Directory /&gt;</span></div><div class="line"><span class="attribute"><span class="nomarkup">Options</span></span> FollowSymLinks</div><div class="line"><span class="attribute">AllowOverride</span> None</div><div class="line"><span class="attribute"><span class="nomarkup">Order</span></span> deny,allow</div><div class="line"><span class="attribute"><span class="nomarkup">Deny</span></span> from <span class="literal">all</span></div><div class="line"><span class="section">&lt;/Directory&gt;</span></div></pre></td></tr></table></figure></p>
<p>发现依然不好使，后来发现2.2版本与2.4版本配置是不一致的。<br><figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="section">&lt;Directory /&gt;</span></div><div class="line">    <span class="attribute"><span class="nomarkup">Options</span></span> Indexes FollowSymLinks</div><div class="line">    <span class="attribute">AllowOverride</span> None </div><div class="line">    <span class="attribute">Require</span> <span class="literal">all</span> granted</div><div class="line"><span class="section">&lt;/Directory&gt;</span></div></pre></td></tr></table></figure></p>
<p>Apache2.2 的配置:<br><figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="attribute"><span class="nomarkup">Order</span></span> deny,allow\ #排序，先拒绝后允许</div><div class="line"><span class="attribute"><span class="nomarkup">Deny</span></span> from <span class="literal">all</span> #拒绝所有</div></pre></td></tr></table></figure></p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="attribute"><span class="nomarkup">Order</span></span> allow,deny #排序，先允许后拒绝</div><div class="line"><span class="attribute"><span class="nomarkup">Allow</span></span> from <span class="literal">all</span> #允许所有</div></pre></td></tr></table></figure>
<p>Apache2.4 的配置:<br><figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">Require</span> <span class="literal">all</span> denied #拒绝所有</div></pre></td></tr></table></figure></p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">Require</span> <span class="literal">all</span> granted #允许所有</div></pre></td></tr></table></figure>
<p>根据2.4版本修改后，Apache成功启动。</p>
<p>Ps:后来发现又报404错误，发现在程序中写的.htacess未生效：<br>便再次更改:<br><figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">AllowOverride</span> <span class="literal">All</span>    //若不设置为<span class="literal">All</span>，则所有的.htacess文件的规则都不生效</div></pre></td></tr></table></figure></p>
<p>之后站点就成功跑通了。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;之前折腾服务器，从&lt;code&gt;Apache2.2&lt;/code&gt;-&amp;gt;&lt;code&gt;Nginx1.10&lt;/code&gt;-&amp;gt;&lt;code&gt;Apache2.4&lt;/code&gt;&lt;br&gt;在指定挂载目录的时候出现这么一个问题,log显示为：&lt;br&gt;403错误&lt;br&gt;&lt;strong&gt;You don’t have permission to access / on this server.&lt;/strong&gt;&lt;br&gt;
    
    </summary>
    
      <category term="linux" scheme="http://bin.bloggao.cn/categories/linux/"/>
    
    
      <category term="linux" scheme="http://bin.bloggao.cn//tags/linux/"/>
    
      <category term="Apache" scheme="http://bin.bloggao.cn//tags/Apache/"/>
    
  </entry>
  
  <entry>
    <title>挂载磁盘和永久挂载</title>
    <link href="http://bin.bloggao.cn/2016/12/23/linux_fdisk/"/>
    <id>http://bin.bloggao.cn/2016/12/23/linux_fdisk/</id>
    <published>2016-12-23T10:02:15.000Z</published>
    <updated>2017-01-04T03:32:54.282Z</updated>
    
    <content type="html"><![CDATA[<p>最近折腾，给磁盘扩容，阿里云得从新挂载，顺道儿这边做个记录。</p>
<p>df -hl(看看有没有挂载成功)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">root@iZ25xadwwi4Z:~# df -hl</div><div class="line">Filesystem      Size  Used Avail Use% Mounted on</div><div class="line">/dev/xvda1       20G  3.4G   16G  18% /</div><div class="line">udev            489M  4.0K  489M   1% /dev</div><div class="line">tmpfs           199M  268K  199M   1% /run</div><div class="line">none            5.0M     0  5.0M   0% /run/lock</div><div class="line">none            498M     0  498M   0% /run/shm</div></pre></td></tr></table></figure></p>
<a id="more"></a>
<p>fdisk -l (看看挂载分区，下面是我的)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">Disk /dev/xvdb: 42.9 GB, 42949672960 bytes</div><div class="line">255 heads, 63 sectors/track, 5221 cylinders, total 83886080 sectors</div><div class="line">Units = sectors of 1 * 512 = 512 bytes</div><div class="line">Sector size (logical/physical): 512 bytes / 512 bytes</div><div class="line">I/O size (minimum/optimal): 512 bytes / 512 bytes</div><div class="line">Disk identifier: 0xb5efb014</div><div class="line"></div><div class="line">Device Boot          Start         End      Blocks   Id  System</div><div class="line">/dev/xvdb1            2048    40000000    19998976+  83  Linux</div><div class="line">/dev/xvdb2        40000001    83886079    21943039+  83  Linux</div></pre></td></tr></table></figure></p>
<p>fdisk /dev/path(磁盘路径)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">Command (m for help): m</div><div class="line">Command action</div><div class="line">   a   toggle a bootable flag</div><div class="line">   b   edit bsd disklabel</div><div class="line">   c   toggle the dos compatibility flag</div><div class="line">   d   delete a partition</div><div class="line">   l   list known partition types</div><div class="line">   m   print this menu</div><div class="line">   n   add a new partition</div><div class="line">   o   create a new empty DOS partition table</div><div class="line">   p   print the partition table</div><div class="line">   q   quit without saving changes</div><div class="line">   s   create a new empty Sun disklabel</div><div class="line">   t   change a partition&apos;s system id</div><div class="line">   u   change display/entry units</div><div class="line">   v   verify the partition table</div><div class="line">   w   write table to disk and exit</div><div class="line">   x   extra functionality (experts only)</div></pre></td></tr></table></figure></p>
<p>顺序：<br>m<br>|<br>n<br>|<br>p<br>分配和设置大小</p>
<p>分配完成<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Command (m for help): wq</div><div class="line">The partition table has been altered!</div><div class="line"></div><div class="line">Calling ioctl() to re-read partition table.</div><div class="line">Syncing disks.</div></pre></td></tr></table></figure></p>
<p>mkfs.ext3 /dev/xvdb1 创建文件系统(需要为其指定一种文件系统才能用来存储数据，这边ext3，可以-t查看)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">root@iZ25xadwwi4Z:~# mkfs.ext3 /dev/xvdb1</div><div class="line">mke2fs 1.42 (29-Nov-2011)</div><div class="line">Filesystem label=</div><div class="line">OS type: Linux</div><div class="line">Block size=4096 (log=2)</div><div class="line">Fragment size=4096 (log=2)</div><div class="line">Stride=0 blocks, Stripe width=0 blocks</div><div class="line">1250928 inodes, 4999744 blocks</div><div class="line">249987 blocks (5.00%) reserved for the super user</div><div class="line">First data block=0</div><div class="line">Maximum filesystem blocks=4294967296</div><div class="line">153 block groups</div><div class="line">32768 blocks per group, 32768 fragments per group</div><div class="line">8176 inodes per group</div><div class="line">Superblock backups stored on blocks: </div><div class="line">	32768, 98304, 163840, 229376, 294912, 819200, 884736, 1605632, 2654208, </div><div class="line">	4096000</div><div class="line"></div><div class="line">Allocating group tables: done                            </div><div class="line">Writing inode tables: done                            </div><div class="line">Creating journal (32768 blocks): done</div><div class="line">Writing superblocks and filesystem accounting information: done</div></pre></td></tr></table></figure></p>
<p>挂载文件系统<br>这边不能选择已有文件，否则会被覆盖掉。<br>mount(临时挂载，好久没挂，我之前忘了重启就没了，到这就结束了。)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">mkdir /liecol</div><div class="line">mount /dev/xvdb1 /liecol/</div></pre></td></tr></table></figure></p>
<p>查看一下:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">root@iZ25xadwwi4Z:~# ls -l /liecol/</div><div class="line">total 16</div><div class="line">drwx------ 2 root root 16384 Dec 23 20:42 lost+found</div></pre></td></tr></table></figure></p>
<p>这一步，别忘了(永久挂载)：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">echo &quot;/dev/xvdb1 /liecol ext3 defaults 1 2&quot; &gt;&gt; /etc/fstab</div></pre></td></tr></table></figure></p>
<p>别和我一样糟糕了。</p>
<p>df -hl 查看一下，再重启试试看就差不多了。</p>
<p>create By liecol<br>2016/12/23</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;最近折腾，给磁盘扩容，阿里云得从新挂载，顺道儿这边做个记录。&lt;/p&gt;
&lt;p&gt;df -hl(看看有没有挂载成功)&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;root@iZ25xadwwi4Z:~# df -hl&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;Filesystem      Size  Used Avail Use% Mounted on&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;/dev/xvda1       20G  3.4G   16G  18% /&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;udev            489M  4.0K  489M   1% /dev&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;tmpfs           199M  268K  199M   1% /run&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;none            5.0M     0  5.0M   0% /run/lock&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;none            498M     0  498M   0% /run/shm&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="linux" scheme="http://bin.bloggao.cn/categories/linux/"/>
    
    
      <category term="linux" scheme="http://bin.bloggao.cn//tags/linux/"/>
    
  </entry>
  
  <entry>
    <title>PHPExcel的使用</title>
    <link href="http://bin.bloggao.cn/2016/12/20/PHPExcel/"/>
    <id>http://bin.bloggao.cn/2016/12/20/PHPExcel/</id>
    <published>2016-12-20T12:50:00.000Z</published>
    <updated>2017-01-04T03:31:15.906Z</updated>
    
    <content type="html"><![CDATA[<p>下载文件<br><strong>PHPExcel.php(file)</strong><br><strong>PHPExcel(dir)</strong><br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">include</span> <span class="string">'PHPExcel.php'</span>;</div><div class="line"><span class="keyword">include</span> <span class="string">'PHPExcel/Writer/Excel2007.php'</span>;</div></pre></td></tr></table></figure></p>
<p>以thinkphp为例贴上一个可抄作业的代码(非tp可删减对应代码即可)：<br>其他单元格细节请自行搜索，没什么太大难度。<br><a id="more"></a><br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div></pre></td><td class="code"><pre><div class="line">    <span class="comment">//导出excel核心代码</span></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">exportExcel</span><span class="params">($fileName,$expTitle,$expCellName,$expTableData)</span></span>&#123;</div><div class="line">        <span class="comment">// vendor('PHPExcel.PHPExcel'); /-----Start</span></div><div class="line">        vendor(<span class="string">"PHPExcel.PHPExcel"</span>);</div><div class="line">        vendor(<span class="string">"PHPExcel.PHPExcel.Writer.Excel5"</span>);</div><div class="line">        vendor(<span class="string">"PHPExcel.PHPExcel.IOFactory.php"</span>);</div><div class="line">        $PHPExcel = <span class="keyword">new</span> \PHPExcel();    <span class="comment">//-----End(这一块可以自行更改)</span></div><div class="line">        $xlsTitle = iconv(<span class="string">'utf-8'</span>, <span class="string">'gb2312'</span>, $expTitle);<span class="comment">//文件名称</span></div><div class="line"><span class="comment">//      $fileName = $_SESSION['loginAccount'].date('_YmdHis');//or $xlsTitle 文件名称可根据自己情况设定</span></div><div class="line"></div><div class="line">        $cellNum = count($expCellName);</div><div class="line">        $dataNum = count($expTableData);</div><div class="line">        </div><div class="line">        $objPHPExcel = $PHPExcel;</div><div class="line">        $cellName = <span class="keyword">array</span>(<span class="string">'A'</span>,<span class="string">'B'</span>,<span class="string">'C'</span>,<span class="string">'D'</span>,<span class="string">'E'</span>,<span class="string">'F'</span>,<span class="string">'G'</span>,<span class="string">'H'</span>,<span class="string">'I'</span>,<span class="string">'J'</span>,<span class="string">'K'</span>,<span class="string">'L'</span>,<span class="string">'M'</span>,<span class="string">'N'</span>,<span class="string">'O'</span>,<span class="string">'P'</span>,<span class="string">'Q'</span>,<span class="string">'R'</span>,<span class="string">'S'</span>,<span class="string">'T'</span>,<span class="string">'U'</span>,<span class="string">'V'</span>,<span class="string">'W'</span>,<span class="string">'X'</span>,<span class="string">'Y'</span>,<span class="string">'Z'</span>,<span class="string">'AA'</span>,<span class="string">'AB'</span>,<span class="string">'AC'</span>,<span class="string">'AD'</span>,<span class="string">'AE'</span>,<span class="string">'AF'</span>,<span class="string">'AG'</span>,<span class="string">'AH'</span>,<span class="string">'AI'</span>,<span class="string">'AJ'</span>,<span class="string">'AK'</span>,<span class="string">'AL'</span>,<span class="string">'AM'</span>,<span class="string">'AN'</span>,<span class="string">'AO'</span>,<span class="string">'AP'</span>,<span class="string">'AQ'</span>,<span class="string">'AR'</span>,<span class="string">'AS'</span>,<span class="string">'AT'</span>,<span class="string">'AU'</span>,<span class="string">'AV'</span>,<span class="string">'AW'</span>,<span class="string">'AX'</span>,<span class="string">'AY'</span>,<span class="string">'AZ'</span>);</div><div class="line">    </div><div class="line">        <span class="keyword">if</span>($cellNum &gt;<span class="number">0</span>)&#123;</div><div class="line">            $objPHPExcel-&gt;getActiveSheet(<span class="number">0</span>)-&gt;mergeCells(<span class="string">'A1:'</span>.$cellName[$cellNum<span class="number">-1</span>].<span class="string">'1'</span>);<span class="comment">//合并单元格</span></div><div class="line">        &#125;<span class="keyword">else</span>&#123;</div><div class="line">            $objPHPExcel-&gt;getActiveSheet(<span class="number">0</span>)-&gt;mergeCells(<span class="string">'A1:'</span>.$cellName[<span class="number">10</span>].<span class="string">'1'</span>);<span class="comment">//合并单元格</span></div><div class="line">        &#125;</div><div class="line">        $objPHPExcel-&gt;setActiveSheetIndex(<span class="number">0</span>)-&gt;setCellValue(<span class="string">'A1'</span>, $expTitle.<span class="string">'  Export time:'</span>.date(<span class="string">'Y-m-d H:i:s'</span>));</div><div class="line">        <span class="keyword">for</span>($i=<span class="number">0</span>;$i&lt;$cellNum;$i++)&#123;</div><div class="line">            $objPHPExcel-&gt;setActiveSheetIndex(<span class="number">0</span>)-&gt;setCellValue($cellName[$i].<span class="string">'2'</span>, $expCellName[$i][<span class="number">1</span>]);</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// Miscellaneous glyphs, UTF-8</span></div><div class="line">        <span class="keyword">for</span>($i=<span class="number">0</span>;$i&lt;$dataNum;$i++)&#123;</div><div class="line">            <span class="keyword">for</span>($j=<span class="number">0</span>;$j&lt;$cellNum;$j++)&#123;</div><div class="line">                $XS_SJ = $expTableData[$i][$expCellName[$j][<span class="number">0</span>]];</div><div class="line">                $bar_code = (string)$expTableData[$i][$expCellName[<span class="number">0</span>][<span class="number">0</span>]];</div><div class="line">                <span class="keyword">if</span>((int)($cellNum<span class="number">-1</span>)==$j &amp;&amp; $bar_code)&#123;</div><div class="line">                    $objDrawing = <span class="keyword">new</span> \PHPExcel_Worksheet_Drawing();</div><div class="line">                    $bar_path = <span class="string">"./Public/Bar_code/"</span>.$bar_code.<span class="string">".png"</span>;</div><div class="line">                    $objDrawing-&gt;setPath($bar_path);</div><div class="line">                    $objDrawing-&gt;setHeight(<span class="number">30</span>);</div><div class="line">                    $objDrawing-&gt;setCoordinates($cellName[$j].($i+<span class="number">3</span>), <span class="string">' '</span>.$XS_SJ);</div><div class="line">                    $objDrawing-&gt;setOffsetX(<span class="number">20</span>);</div><div class="line">                    $objDrawing-&gt;setRotation(<span class="number">12</span>);</div><div class="line">                    $objDrawing-&gt;getShadow()-&gt;setVisible(<span class="keyword">true</span>);</div><div class="line">                    $objDrawing-&gt;getShadow()-&gt;setDirection(<span class="number">45</span>);</div><div class="line">                    $objDrawing-&gt;setWorksheet($objPHPExcel-&gt;getActiveSheet());</div><div class="line">                &#125;</div><div class="line">                <span class="comment">//用' ' 处理数字为文本,以免excel中数字太大时科学计数法导致错误</span></div><div class="line">                $objPHPExcel-&gt;getActiveSheet(<span class="number">0</span>)-&gt;setCellValue($cellName[$j].($i+<span class="number">3</span>), <span class="string">' '</span>.$XS_SJ);<span class="comment">//控制不能显示科学计数数字。</span></div><div class="line">                $objPHPExcel-&gt;getActiveSheet(<span class="number">0</span>)-&gt;getColumnDimension($cellName[$j])-&gt;setWidth(<span class="number">20</span>);</div><div class="line">                $objPHPExcel-&gt;getActiveSheet()-&gt;getDefaultRowDimension($i)-&gt;setRowHeight(<span class="number">22</span>);</div><div class="line"></div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    </div><div class="line">        header(<span class="string">'pragma:public'</span>);</div><div class="line">        header(<span class="string">"Expires: 0"</span>);</div><div class="line">        header(<span class="string">"Cache-Control:must-revalidate,post-check=0,pre-check=0"</span>);</div><div class="line">        header(<span class="string">"Content-Type:application/force-download"</span>);</div><div class="line">        header(<span class="string">"Content-Type:application/octet-stream"</span>);</div><div class="line">        header(<span class="string">"Content-Type:application/download"</span>);</div><div class="line">        header(<span class="string">'Content-type:application/vnd.ms-excel;charset=utf-8;name="'</span>.$xlsTitle.<span class="string">'.xls"'</span>);</div><div class="line">        header(<span class="string">"Content-Disposition:attachment;filename=$fileName.xls"</span>);<span class="comment">//attachment新窗口打印inline本窗口打印</span></div><div class="line">        $objWriter = \PHPExcel_IOFactory::createWriter($objPHPExcel, <span class="string">'Excel5'</span>);</div><div class="line">        $objWriter-&gt;save(<span class="string">'php://output'</span>);</div><div class="line">        <span class="comment">// $objPHPExcel = PHPExcel_IOFactory::load($fileName);</span></div><div class="line">        <span class="keyword">exit</span>;</div><div class="line">    &#125;</div></pre></td></tr></table></figure></p>
<p>调用：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">export_to_excel</span><span class="params">()</span></span>&#123;</div><div class="line"></div><div class="line">       $expTitle = <span class="string">'liecol快递'</span> ; <span class="comment">//设置文件名</span></div><div class="line">       $fileName = <span class="string">'liecol快递'</span> . date(<span class="string">'Ymd'</span>); <span class="comment">//设置文件名</span></div><div class="line">       </div><div class="line">       $expCellName  = <span class="keyword">array</span>(</div><div class="line">               <span class="keyword">array</span>(<span class="string">'tracking_number'</span>,<span class="string">'分单号'</span>),</div><div class="line">               <span class="keyword">array</span>(<span class="string">'sender_name'</span>,<span class="string">'发件人'</span>),</div><div class="line">               <span class="keyword">array</span>(<span class="string">'sender_tel'</span>,<span class="string">'发件人电话'</span>),</div><div class="line">               <span class="keyword">array</span>(<span class="string">'sender_address'</span>,<span class="string">'发件人地址'</span>),</div><div class="line">               <span class="keyword">array</span>(<span class="string">'sender_country'</span>,<span class="string">'发件人国家'</span>),</div><div class="line">               <span class="keyword">array</span>(<span class="string">'recipients_name'</span>,<span class="string">'收件人姓名'</span>),</div><div class="line">               <span class="keyword">array</span>(<span class="string">'recipients_address'</span>,<span class="string">'收件人地址'</span>),</div><div class="line">               <span class="keyword">array</span>(<span class="string">'recipients_code'</span>,<span class="string">'收件人邮编'</span>),</div><div class="line">               <span class="keyword">array</span>(<span class="string">'recipients_tel'</span>,<span class="string">'收件人电话'</span>),</div><div class="line">               <span class="keyword">array</span>(<span class="string">'recipients_id'</span>,<span class="string">'证件号'</span>),</div><div class="line">               <span class="keyword">array</span>(<span class="string">'update_time'</span>,<span class="string">'订单日期'</span>),</div><div class="line">               <span class="keyword">array</span>(<span class="string">'bar_code'</span>,<span class="string">'条形码'</span>)</div><div class="line">       );</div><div class="line">       </div><div class="line">       $expTableData = D(<span class="string">'Order'</span>)-&gt;field(<span class="string">'tracking_number,sender_name,sender_tel,sender_address,sender_country,recipients_name,recipients_address,recipients_code,recipients_tel,recipients_id,update_time'</span>)-&gt;select();</div><div class="line">       <span class="keyword">$this</span>-&gt;exportExcel($fileName,$expTitle,$expCellName,$expTableData);</div><div class="line"></div><div class="line">   &#125;</div></pre></td></tr></table></figure></p>
<p>create By<br>liecol-晓斌<br>2016-12-20</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;下载文件&lt;br&gt;&lt;strong&gt;PHPExcel.php(file)&lt;/strong&gt;&lt;br&gt;&lt;strong&gt;PHPExcel(dir)&lt;/strong&gt;&lt;br&gt;&lt;figure class=&quot;highlight php&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;PHPExcel.php&#39;&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;PHPExcel/Writer/Excel2007.php&#39;&lt;/span&gt;;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;以thinkphp为例贴上一个可抄作业的代码(非tp可删减对应代码即可)：&lt;br&gt;其他单元格细节请自行搜索，没什么太大难度。&lt;br&gt;
    
    </summary>
    
      <category term="php" scheme="http://bin.bloggao.cn/categories/php/"/>
    
    
      <category term="php" scheme="http://bin.bloggao.cn//tags/php/"/>
    
      <category term="phpexcel" scheme="http://bin.bloggao.cn//tags/phpexcel/"/>
    
  </entry>
  
  <entry>
    <title>php中关于redis的使用</title>
    <link href="http://bin.bloggao.cn/2016/11/23/php_redis/"/>
    <id>http://bin.bloggao.cn/2016/11/23/php_redis/</id>
    <published>2016-11-23T14:22:00.000Z</published>
    <updated>2017-01-04T03:31:31.553Z</updated>
    
    <content type="html"><![CDATA[<p><em>安装扩展我这边不做过多说明，大家自行搜索一下。</em></p>
<p>php连接到redis服务<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">    <span class="comment">//连接本地的 Redis 服务</span></div><div class="line">   $redis = <span class="keyword">new</span> Redis();</div><div class="line">   $redis-&gt;connect(<span class="string">'127.0.0.1'</span>, <span class="number">6379</span>);</div><div class="line">   <span class="keyword">echo</span> <span class="string">"Connection to liecol server."</span>;</div><div class="line">         <span class="comment">//查看服务是否运行</span></div><div class="line">   <span class="keyword">echo</span> <span class="string">"Running: "</span>+ $redis-&gt;ping();</div><div class="line"></div><div class="line">   <span class="comment">//Connection to liecol server.</span></div><div class="line">   <span class="comment">//Running: PONG</span></div><div class="line">   <span class="comment">//新建数据</span></div><div class="line">   $redis-&gt;set(<span class="string">"liecol"</span>, <span class="string">"name"</span>);</div><div class="line">   $arList = $redis-&gt;get(<span class="string">"liecol-list"</span>);</div><div class="line"></div><div class="line">   $redis-&gt;lpush(<span class="string">"liecol1"</span>, <span class="string">"Redis"</span>);</div><div class="line">   $redis-&gt;lpush(<span class="string">"liecol1"</span>, <span class="string">"Mongodb"</span>);</div><div class="line">   $redis-&gt;lpush(<span class="string">"liecol1"</span>, <span class="string">"Mysql"</span>);</div><div class="line">   $arList = $redis-&gt;lrange(<span class="string">"liecol1"</span>, <span class="number">0</span> ,<span class="number">5</span>);</div><div class="line"></div><div class="line">   $arList = $redis-&gt;keys(<span class="string">"*"</span>);</div><div class="line">   <span class="comment">//liecol</span></div><div class="line">   <span class="comment">//liecol1</span></div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure></p>
<a id="more"></a>
<p>几个常用的命令：<br>setex 带生存时间的写入值<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$redis-&gt;setex(<span class="string">'key'</span>, <span class="number">3600</span>, <span class="string">'value'</span>); <span class="comment">// sets key → value, with 1h TTL.</span></div></pre></td></tr></table></figure></p>
<p>setnx 判断是否重复的，写入值<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$redis-&gt;setnx(<span class="string">'key'</span>, <span class="string">'value'</span>);</div><div class="line">$redis-&gt;setnx(<span class="string">'key'</span>, <span class="string">'value'</span>);</div></pre></td></tr></table></figure></p>
<p>delete  删除指定key的值<br>返回已经删除key的个数（长整数）<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$redis-&gt;delete(<span class="string">'key1'</span>, <span class="string">'key2'</span>);</div><div class="line">$redis-&gt;delete(<span class="keyword">array</span>(<span class="string">'key3'</span>, <span class="string">'key4'</span>, <span class="string">'key5'</span>));</div></pre></td></tr></table></figure></p>
<p>ttl<br>得到一个key的生存时间</p>
<p>exists<br>判断key是否存在。存在 true 不在 false</p>
<p>lSize<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$redis-&gt;lSize(<span class="string">'key'</span>);</div></pre></td></tr></table></figure></p>
<p>返回名称为key的list有多少个元素</p>
<p>以下为php-redis中文文档(内含命令介绍)<br><a href="http://bbs.redis.cn/forum.php?mod=viewthread&amp;tid=481" target="_blank" rel="external">http://bbs.redis.cn/forum.php?mod=viewthread&amp;tid=481</a></p>
<p>create By<br>liecol-晓斌<br>2016-11-23</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;em&gt;安装扩展我这边不做过多说明，大家自行搜索一下。&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;php连接到redis服务&lt;br&gt;&lt;figure class=&quot;highlight php&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;15&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;16&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;17&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;18&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;19&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;20&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;21&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;22&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;23&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&amp;lt;?php&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;//连接本地的 Redis 服务&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;   $redis = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Redis();&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;   $redis-&amp;gt;connect(&lt;span class=&quot;string&quot;&gt;&#39;127.0.0.1&#39;&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;6379&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;   &lt;span class=&quot;keyword&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;Connection to liecol server.&quot;&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;         &lt;span class=&quot;comment&quot;&gt;//查看服务是否运行&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;   &lt;span class=&quot;keyword&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;Running: &quot;&lt;/span&gt;+ $redis-&amp;gt;ping();&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;   &lt;span class=&quot;comment&quot;&gt;//Connection to liecol server.&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;   &lt;span class=&quot;comment&quot;&gt;//Running: PONG&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;   &lt;span class=&quot;comment&quot;&gt;//新建数据&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;   $redis-&amp;gt;set(&lt;span class=&quot;string&quot;&gt;&quot;liecol&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;name&quot;&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;   $arList = $redis-&amp;gt;get(&lt;span class=&quot;string&quot;&gt;&quot;liecol-list&quot;&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;   $redis-&amp;gt;lpush(&lt;span class=&quot;string&quot;&gt;&quot;liecol1&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;Redis&quot;&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;   $redis-&amp;gt;lpush(&lt;span class=&quot;string&quot;&gt;&quot;liecol1&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;Mongodb&quot;&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;   $redis-&amp;gt;lpush(&lt;span class=&quot;string&quot;&gt;&quot;liecol1&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;Mysql&quot;&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;   $arList = $redis-&amp;gt;lrange(&lt;span class=&quot;string&quot;&gt;&quot;liecol1&quot;&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; ,&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;   $arList = $redis-&amp;gt;keys(&lt;span class=&quot;string&quot;&gt;&quot;*&quot;&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;   &lt;span class=&quot;comment&quot;&gt;//liecol&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;   &lt;span class=&quot;comment&quot;&gt;//liecol1&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="nosql" scheme="http://bin.bloggao.cn/categories/nosql/"/>
    
    
      <category term="php" scheme="http://bin.bloggao.cn//tags/php/"/>
    
      <category term="redis" scheme="http://bin.bloggao.cn//tags/redis/"/>
    
  </entry>
  
</feed>
